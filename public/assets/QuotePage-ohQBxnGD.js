import{r as g,j as e,b as D,S as P}from"./index-CShLHsUt.js";import{z as o,R,a as Z,b as U,T as W,P as Q,M as F}from"./Pagination-2Q04ZmxJ.js";/* empty css             */import Y from"./purify.es-Ci5xwkH_.js";import{u as H}from"./useGoogleAutocomplete-C2ALqIRo.js";import{o as G,R as J}from"./EyeOutlined-B28M-sP9.js";import{R as K}from"./MailOutlined-O_E7qy0n.js";const X=o.object({load_type:o.enum(["FTL","LTL"],{message:"Please select a valid load type"}),quote_booked_by:o.string().max(100,"Booked By cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]*$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed").optional(),quote_temperature:o.union([o.string().max(10,"Temperature cannot exceed 10 characters").regex(/^-?\d+(\.\d+)?\s?[°CFK]?$/,"Enter a valid temperature (e.g., 5°C, -10F, 273K)"),o.number()]).optional(),quote_customer:o.string().min(1,"Customer is required").max(200,"Customer name cannot exceed 200 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_cust_ref_no:o.string().min(1,"Customer Ref. No is required").max(100,"Customer Ref. No cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_hot:o.boolean().optional(),quote_team:o.boolean().optional(),quote_air_ride:o.boolean().optional(),quote_tarp:o.boolean().optional(),quote_hazmat:o.boolean().optional()}),ee=[{key:"quote_booked_by",label:"Booked By",placeholder:"Enter Person Who Booked",type:"text"},{key:"quote_temperature",label:"Temperature",placeholder:"Enter Required Temperature",type:"text"},{key:"quote_hot",label:"Hot",type:"boolean"},{key:"quote_team",label:"Team",type:"boolean"},{key:"quote_air_ride",label:"Air Ride",type:"boolean"},{key:"quote_tarp",label:"TARP",type:"boolean"},{key:"quote_hazmat",label:"Hazmat",type:"boolean"}],te=({formQuote:t,setFormQuote:b})=>{const[i,m]=g.useState({}),[d,h]=g.useState([]),[p,N]=g.useState([]),k=["FTL","LTL"],E="http://127.0.0.1:8000/api";g.useEffect(()=>{(async()=>{try{const y=localStorage.getItem("token"),r=await D.get(`${E}/customer`,{headers:{Authorization:`Bearer ${y}`}});if(!r||!r.data){console.error("API response is undefined or invalid:",r);return}console.log("Fetched customers:",r.data);const s=r.data.map(a=>({value:a.cust_name,label:a.cust_name,refNo:a.cust_ref_no}));h(s)}catch(y){console.error("Error fetching customers:",y)}})()},[]),g.useEffect(()=>{if(t.quote_customer){const l=d.find(y=>y.value===t.quote_customer);N(l?[{value:l.refNo,label:l.refNo}]:[])}else N([])},[t.quote_customer,d]);const v=(l,y)=>{let r=y,s="";const a={...t,[l]:r},n=X.safeParse(a);if(!n.success){const c=n.error.errors.find(f=>f.path[0]===l);s=c?c.message:""}m(c=>({...c,[l]:s})),b(a)};return e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"equipment",children:["Load Type ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"equipment",value:t.quote_type,onChange:l=>b(y=>({...y,quote_type:l.target.value})),children:[e.jsx("option",{value:"",disabled:!0,children:"Select..."}),k.map(l=>e.jsx("option",{value:l,children:l},l))]}),i.quote_type&&e.jsx("span",{className:"error",style:{color:"red"},children:i.quote_type})]}),e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"customer",children:["Customer ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer",value:t.quote_customer||"",onChange:l=>v("quote_customer",l.target.value),onBlur:()=>v("quote_customer",t.quote_customer||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a customer"}),d.length>0?d.map((l,y)=>e.jsx("option",{value:l.value,children:l.label},`${l.refNo}-${y}`)):e.jsx("option",{disabled:!0,children:"No customers found"})]}),i.customer&&e.jsx("span",{className:"error",style:{color:"red"},children:i.customer})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsxs("label",{htmlFor:"customerRefNo",children:["Customer Ref. No ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer_ref_no",value:t.quote_cust_ref_no||"",onChange:l=>v("quote_cust_ref_no",l.target.value),onBlur:()=>v("quote_cust_ref_no",t.quote_cust_ref_no||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reference number"}),p.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]}),i.customer_ref_no&&e.jsx("span",{className:"error",style:{color:"red"},children:i.customer_ref_no})]}),ee.map(({key:l,label:y,placeholder:r,type:s})=>e.jsx("div",{children:e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[s==="boolean"?e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",id:l,checked:!!t[l],onChange:a=>v(l,a.target.checked),style:{transform:"scale(1.1)",cursor:"pointer",margin:0}}),e.jsx("label",{htmlFor:l,style:{margin:0,whiteSpace:"nowrap"},children:y})]}):e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsx("label",{htmlFor:l,children:y})," ",e.jsx("input",{type:"text",id:l,placeholder:r,value:String(t[l]||""),onChange:a=>v(l,a.target.value)})]}),i[l]&&e.jsx("span",{className:"error",style:{color:"red"},children:i[l]})]},l)},l))]})]})},se=o.object({address:o.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:o.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:o.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:o.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:o.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:o.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:o.string().regex(/^\d{2}-\d{2}-\d{4}$/,{message:"Date must be in DD-MM-YYYY format"}).optional(),time:o.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:o.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:o.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),pickup_po:o.string().max(100,"Pickup PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid pickup PO format").optional(),packages:o.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:o.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:o.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:o.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),re=({setQuote:t,quote_pickup:b,index:i,handlePickupChange:m,handleRemovePickup:d,onAddPickup:h})=>{const p=b[i]??{},[N,k]=g.useState({}),v=H(r=>{const s=a=>{var n,c;return((c=(n=r.address_components)==null?void 0:n.find(f=>f.types.includes(a)))==null?void 0:c.long_name)||""};t(a=>({...a,quote_pickup:a.quote_pickup.map((n,c)=>c===i?{...n,address:`${s("street_number")} ${s("route")}`.trim(),city:s("locality"),state:s("administrative_area_level_1"),country:s("country"),postal:s("postal_code")}:n)}))}),l=g.useCallback((r,s)=>{const a=Y.sanitize(s);let n=a;(r==="packages"||r==="weight")&&(n=a?Number(a):0);let c="";if(r==="date"&&/^\d{4}-\d{2}-\d{2}$/.test(a)){const[j,S,w]=a.split("-")}if(r==="date"){const j=new Date(s).toISOString().split("T")[0];m(i,{...p,[r]:j});return}const f={...p,[r]:n},C=se.safeParse(f);if(!C.success){const j=C.error.errors.find(S=>S.path[0]===r);c=j?j.message:""}k(j=>({...j,[r]:c})),m(i,f)},[p,m,i]),y=[{label:"Address",key:"address",type:"text",placeholder:"Enter street address"},{label:"City",key:"city",type:"text",placeholder:"Enter city name"},{label:"State",key:"state",type:"text",placeholder:"Enter state"},{label:"Country",key:"country",type:"text",placeholder:"Enter country"},{label:"Postal Code",key:"postal",type:"text",placeholder:"Enter postal code"},{label:"Phone",key:"phone",type:"text",placeholder:"Enter phone number"},{label:"Date",key:"date",type:"date"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",type:"text",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",type:"text",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",type:"text",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",type:"number",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",type:"number",placeholder:"Enter weight (kg/lbs)"},{label:"Dimensions",key:"dimensions",type:"text",placeholder:"Enter dimensions (LxWxH cm/inches)"},{label:"Notes",key:"notes",type:"textarea",placeholder:"Enter additional notes"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:y.map(({label:r,key:s,type:a,placeholder:n})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${s}-${i}`,children:r}),a==="textarea"?e.jsx("textarea",{id:`${s}-${i}`,name:s,value:p[s]||"",onChange:c=>l(s,c.target.value),placeholder:n,rows:4}):e.jsx("input",{id:`${s}-${i}`,name:s,type:a,value:p[s]||"",onChange:c=>l(s,c.target.value),placeholder:n,ref:s==="address"?v:void 0}),N[s]&&e.jsx("span",{className:"error",style:{color:"red"},children:N[s]})]},s))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx(R,{})}),e.jsx("button",{type:"button",onClick:()=>d(i),className:"delete-button",children:e.jsx(Z,{})})]})]})},ae=o.object({address:o.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:o.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:o.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:o.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:o.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:o.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:o.string().regex(/^\d{2}-\d{2}-\d{4}$/,{message:"Date must be in DD-MM-YYYY format"}).optional(),time:o.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:o.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:o.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),delivery_po:o.string().max(100,"Delivery PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid delivery PO format").optional(),packages:o.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:o.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:o.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:o.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),le=({setQuote:t,quote_delivery:b,index:i,handleDeliveryChange:m,handleRemoveDelivery:d,onAddDelivery:h})=>{const p=b[i]??{},[N,k]=g.useState({}),v=H(r=>{const s=a=>{var n,c;return((c=(n=r.address_components)==null?void 0:n.find(f=>f.types.includes(a)))==null?void 0:c.long_name)||""};t(a=>({...a,quote_delivery:a.quote_delivery.map((n,c)=>c===i?{...n,address:`${s("street_number")} ${s("route")}`.trim(),city:s("locality"),state:s("administrative_area_level_1"),country:s("country"),postal:s("postal_code")}:n)}))}),l=g.useCallback((r,s)=>{const a=Y.sanitize(s);let n=a;(r==="packages"||r==="weight")&&(n=a?Number(a):0);let c="";if(r==="date"&&/^\d{4}-\d{2}-\d{2}$/.test(a)){const[j,S,w]=a.split("-")}if(r==="date"){const j=new Date(s).toISOString().split("T")[0];m(i,{...p,[r]:j});return}const f={...p,[r]:n},C=ae.safeParse(f);if(!C.success){const j=C.error.errors.find(S=>S.path[0]===r);c=j?j.message:""}k(j=>({...j,[r]:c})),m(i,f)},[p,m,i]),y=[{label:"Address",key:"address",type:"text",placeholder:"Enter street address"},{label:"City",key:"city",type:"text",placeholder:"Enter city name"},{label:"State",key:"state",type:"text",placeholder:"Enter state"},{label:"Country",key:"country",type:"text",placeholder:"Enter country"},{label:"Postal Code",key:"postal",type:"text",placeholder:"Enter postal code"},{label:"Phone",key:"phone",type:"text",placeholder:"Enter phone number"},{label:"Date",key:"date",type:"date",placeholder:"Enter date (YYYY-MM-DD)"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",type:"text",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",type:"text",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",type:"text",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",type:"number",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",type:"number",placeholder:"Enter weight (kg/lbs)"},{label:"Dimensions",key:"dimensions",type:"text",placeholder:"Enter dimensions (LxWxH cm/inches)"},{label:"Notes",key:"notes",type:"textarea",placeholder:"Enter additional notes"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:y.map(({label:r,key:s,type:a,placeholder:n})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${s}-${i}`,children:r}),a==="textarea"?e.jsx("textarea",{id:`${s}-${i}`,name:s,value:p[s]||"",onChange:c=>l(s,c.target.value),placeholder:n,rows:4}):e.jsx("input",{id:`${s}-${i}`,name:s,type:a,value:p[s]||"",onChange:c=>l(s,c.target.value),placeholder:n,ref:s==="address"?v:void 0}),N[s]&&e.jsx("span",{className:"error",style:{color:"red"},children:N[s]})]},s))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx(R,{})}),e.jsx("button",{type:"button",onClick:()=>d(i),className:"delete-button",children:e.jsx(Z,{})})]})]})},oe="http://127.0.0.1:8000/api",ne=(t,b,i)=>{const[m,d]=g.useState({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""});g.useEffect(()=>{if(t){const r=Array.isArray(t.quote_pickup)?t.quote_pickup:JSON.parse(t.quote_pickup||"[]"),s=Array.isArray(t.quote_delivery)?t.quote_delivery:JSON.parse(t.quote_delivery||"[]"),a={...t,quote_pickup:r.length>0?r:[],quote_delivery:s.length>0?s:[]};d(a)}},[t]);const h=()=>!!m.quote_type&&!!m.quote_customer&&!!m.quote_cust_ref_no;return{formQuote:m,setFormQuote:d,updateQuote:async()=>{var r,s;if(!h()){P.fire("Validation Error","Please fill in all required fields.","error");return}try{const a=localStorage.getItem("token");if(!a||typeof a!="string"){P.fire({icon:"error",title:"Unauthorized",text:"Please log in again."});return}const n=await D.put(`${oe}/quote/${m.id}`,m,{headers:{Authorization:`Bearer ${a}`}});P.fire({icon:"success",title:"Updated!",text:"Quote updated successfully."}),i(n.data),b()}catch(a){console.error("Error updating quote:",((r=a.response)==null?void 0:r.data)||a.message),P.fire({icon:"error",title:"Oops...",text:((s=a.response)==null?void 0:s.status)===401?"Unauthorized. Please log in again.":"Failed to update quote."})}},handleAddPickup:()=>{d(r=>r&&{...r,quote_pickup:[...r.quote_pickup,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]})},handleRemovePickup:r=>{d(s=>s&&{...s,quote_pickup:s.quote_pickup.filter((a,n)=>n!==r)})},handlePickupChange:(r,s)=>{d(a=>a&&{...a,quote_pickup:a.quote_pickup.map((n,c)=>c===r?s:n)})},handleAddDelivery:()=>{d(r=>r&&{...r,quote_delivery:[...r.quote_delivery,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]})},handleRemoveDelivery:r=>{d(s=>s&&{...s,quote_delivery:s.quote_delivery.filter((a,n)=>n!==r)})},handleDeliveryChange:(r,s)=>{d(a=>a&&{...a,quote_delivery:a.quote_delivery.map((n,c)=>c===r?s:n)})}}},ie=({quote:t,onClose:b,onUpdate:i})=>{var y;const{formQuote:m,setFormQuote:d,updateQuote:h,handleAddPickup:p,handleRemovePickup:N,handlePickupChange:k,handleAddDelivery:E,handleRemoveDelivery:v,handleDeliveryChange:l}=ne(t,b,i);return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:r=>{r.preventDefault(),h()},className:"form-main",children:[m&&e.jsxs(e.Fragment,{children:[e.jsx(te,{formQuote:m,setFormQuote:d}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Origin"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[(y=m.quote_pickup)==null?void 0:y.map((r,s)=>e.jsx(re,{quote:m,setQuote:d,quote_pickup:m.quote_pickup,index:s,onAddPickup:p,handlePickupChange:k,handleRemovePickup:N},s)),m.quote_pickup.length===0&&e.jsx("button",{type:"button",onClick:p,className:"add-button",children:e.jsx(R,{})})]})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Destination"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[m.quote_delivery.map((r,s)=>e.jsx(le,{quote:m,setQuote:d,quote_delivery:m.quote_delivery,index:s,onAddDelivery:E,handleDeliveryChange:l,handleRemoveDelivery:v},s)),m.quote_delivery.length===0&&e.jsx("button",{type:"button",onClick:E,className:"add-button",children:e.jsx(R,{})})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-submit",children:"Save"}),e.jsx("button",{type:"button",className:"btn-cancel",onClick:b,children:"Cancel"})]})]})})},ce=({formQuote:t})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"quoteType",children:"Quote Type"}),e.jsx("div",{children:t.quote_type||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"quote_customer",children:"Customer"}),e.jsx("div",{children:t.quote_customer||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"customerRefNo",children:"Customer Ref. No"}),e.jsx("div",{children:t.quote_cust_ref_no||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"accNo",children:"Booked By"}),e.jsx("div",{children:t.quote_booked_by||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"branch",children:"Temperature"}),e.jsx("div",{children:t.quote_temperature||"N/A"})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Hot",style:{display:"block"},children:"Hot"}),e.jsx("span",{children:t.quote_hot?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Team",style:{display:"block"},children:"Team"}),e.jsx("span",{children:t.quote_team?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Air Ride",style:{display:"block"},children:"Air Ride"}),e.jsx("span",{children:t.quote_air_ride?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"TARP",style:{display:"block"},children:"TARP"}),e.jsx("span",{children:t.quote_tarp?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Hazmat",style:{display:"block"},children:"Hazmat"}),e.jsx("span",{children:t.quote_hazmat?"Yes":"No"})]})]})]}),de=({delivery:t})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Address"}),e.jsx("div",{children:t.address||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"City"}),e.jsx("div",{children:t.city||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"State"}),e.jsx("div",{children:t.state||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Postal Code"}),e.jsx("div",{children:t.postal||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:t.country||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Date"}),e.jsx("div",{children:t.date||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Time"}),e.jsx("div",{children:t.time||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Currency"}),e.jsx("div",{children:t.currency||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Equipment"}),e.jsx("div",{children:t.equipment||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Pickup PO"}),e.jsx("div",{children:t.pickup_po||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Phone"}),e.jsx("div",{children:t.phone||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Packages"}),e.jsx("div",{children:t.packages||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Weight"}),e.jsx("div",{children:t.weight||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Dimensions"}),e.jsx("div",{children:t.dimensions||""})]})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Notes"}),e.jsx("div",{children:t.notes||""})]})]}),ue=({pickup:t})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Address"}),e.jsx("div",{children:t.address||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"City"}),e.jsx("div",{children:t.city||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"State"}),e.jsx("div",{children:t.state||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Postal Code"}),e.jsx("div",{children:t.postal||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:t.country||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Date"}),e.jsx("div",{children:t.date||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Time"}),e.jsx("div",{children:t.time||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Currency"}),e.jsx("div",{children:t.currency||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Equipment"}),e.jsx("div",{children:t.equipment||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Pickup PO"}),e.jsx("div",{children:t.pickup_po||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Phone"}),e.jsx("div",{children:t.phone||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Packages"}),e.jsx("div",{children:t.packages||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Weight"}),e.jsx("div",{children:t.weight||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Dimensions"}),e.jsx("div",{children:t.dimensions||""})]})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Notes"}),e.jsx("div",{children:t.notes||""})]})]}),me=({quote:t,onClose:b})=>{const[i,m]=g.useState({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""});return g.useEffect(()=>{if(console.log("quote:",t),console.log("quote_pickup:",t==null?void 0:t.quote_pickup),t){let d=[],h=[];if(Array.isArray(t.quote_pickup))d=t.quote_pickup;else if(typeof t.quote_pickup=="string")try{d=JSON.parse(t.quote_pickup),Array.isArray(d)||(d=[])}catch(p){console.error("Failed to parse quote_pickup:",p),d=[]}if(Array.isArray(t.quote_delivery))h=t.quote_delivery;else if(typeof t.quote_delivery=="string")try{h=JSON.parse(t.quote_delivery),Array.isArray(h)||(h=[])}catch(p){console.error("Failed to parse quote_delivery:",p),h=[]}m({...t,quote_pickup:d,quote_delivery:h})}},[t]),e.jsx("div",{className:"form-container",children:e.jsxs("form",{className:"form-main",children:[e.jsx(ce,{formQuote:i}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Pickup"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:i.quote_pickup.map((d,h)=>e.jsx(ue,{pickup:d,index:h},h))})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Delivery"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:i.quote_delivery.map((d,h)=>e.jsx(de,{delivery:d,index:h},h))})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"button",className:"btn-cancel",onClick:b,style:{padding:"9px 15px"},children:"Cancel"})})]})})},B="http://127.0.0.1:8000/api",pe=()=>{const[t,b]=g.useState([]),[i,m]=g.useState(!0),[d,h]=g.useState(""),[p,N]=g.useState("created_at"),[k,E]=g.useState(!0),[v,l]=g.useState(1),[y,r]=g.useState(null),[s,a]=g.useState(!1),[n,c]=g.useState(!1),[f,C]=g.useState([]),[j,S]=g.useState(10),[w,$]=g.useState(!1),[I,z]=g.useState({subject:"",content:""}),T=async()=>{try{const u=localStorage.getItem("token");if(!u)throw new Error("No token found");m(!0);const{data:_}=await D.get(`${B}/quote`,{headers:{Authorization:`Bearer ${u}`}});b(_)}catch(u){console.error("Error loading quotes:",u),M(u)}finally{m(!1)}};g.useEffect(()=>{T()},[]);const M=u=>{u.response&&u.response.status===401&&P.fire({icon:"error",title:"Unauthorized",text:"You need to log in to access this resource."})},x=u=>{p===u?E(!k):(N(u),E(!1))},V=t.filter(u=>Object.values(u).some(_=>_==null?void 0:_.toString().toLowerCase().includes(d.toLowerCase()))),O=V.sort((u,_)=>{let q=u[p]??"",A=_[p]??"";return typeof q=="string"&&typeof A=="string"?k?A.localeCompare(q):q.localeCompare(A):typeof q=="number"&&typeof A=="number"?k?A-q:q-A:0}).slice((v-1)*j,v*j),L=Math.ceil(V.length/j);return{fetchQuotes:T,quotes:t,loading:i,searchQuery:d,setSearchQuery:h,sortBy:p,sortDesc:k,selectedIds:f,setSelectedIds:C,paginatedData:O,totalPages:L,currentPage:v,setCurrentPage:l,isEditModalOpen:s,isViewModalOpen:n,isEmailModalOpen:w,selectedQuote:y,openEditModal:u=>{r(u),a(!0)},closeEditModal:()=>{a(!1),r(null)},openViewModal:u=>{r(u),c(!0)},closeViewModal:()=>{c(!1),r(null)},setEditModalOpen:a,setViewModalOpen:c,setEmailModalOpen:$,toggleSelectAll:()=>{f.length===O.length?C([]):C(O.map(u=>u.id))},toggleSelect:u=>{C(_=>_.includes(u)?_.filter(q=>q!==u):[..._,u])},deleteSelected:async()=>{if(f.length===0){P.fire({icon:"warning",title:"No record selected",text:"Please select a record to delete."});return}if((await P.fire({title:"Are you sure?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete selected!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const _=localStorage.getItem("token");if(!_)throw new Error("No token found");await Promise.all(f.map(q=>D.delete(`${B}/quote/${q}`,{headers:{Authorization:`Bearer ${_}`}}))),b(q=>q.filter(A=>!f.includes(A.id))),C([]),P.fire("Deleted!","Selected quotes have been deleted.","success")}catch(_){console.error("Error deleting quotes:",_),P.fire({icon:"error",title:"Error!",text:"Failed to delete selected quotes."})}},emailData:I,setEmailData:z,sendEmails:async()=>{if(f.length===0){P.fire({icon:"warning",title:"No quote selected",text:"Please select quote to send emails to."});return}try{const u=localStorage.getItem("token");if(!u)throw new Error("No token found");await D.post(`${B}/email`,{ids:f,...I,module:"quotes"},{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}}),P.fire("Success!","Emails have been sent.","success"),$(!1),C([])}catch(u){console.error("Error sending emails:",u),P.fire("Error!","Failed to send emails.","error")}},handleSort:x,updateQuote:u=>{b(_=>_.map(q=>q.id===u.id?{...q,...u}:q))},handlePageChange:u=>{l(u)}}},he=()=>{const{quotes:t,loading:b,searchQuery:i,setSearchQuery:m,sortBy:d,sortDesc:h,selectedIds:p,paginatedData:N,totalPages:k,currentPage:E,isEditModalOpen:v,isViewModalOpen:l,isEmailModalOpen:y,selectedQuote:r,openEditModal:s,openViewModal:a,setEditModalOpen:n,setViewModalOpen:c,setEmailModalOpen:f,toggleSelectAll:C,toggleSelect:j,deleteSelected:S,sendEmails:w,handleSort:$,updateQuote:I,handlePageChange:z}=pe(),T=x=>x.key==="checkbox"||x.key==="actions"?x.label:e.jsxs("div",{className:"sortable-header",onClick:()=>$(x.key),children:[x.label,e.jsx("span",{className:"sort-icon",children:d===x.key?h?"▼":"▲":"▼"})]}),M=[{key:"checkbox",label:e.jsx("input",{type:"checkbox",onChange:C,checked:p.length===N.length&&N.length>0}),render:x=>e.jsx("input",{type:"checkbox",checked:p.includes(x.id),onChange:()=>j(x.id)})},{key:"quote_customer",label:"Customer",render:x=>x.quote_customer||e.jsx("span",{children:"-"})},{key:"quote_cust_ref_no",label:"Customer Ref#",render:x=>x.quote_cust_ref_no||e.jsx("span",{children:"-"})},{key:"quote_type",label:"Type",render:x=>x.quote_type||e.jsx("span",{children:"-"})},{key:"quote_booked_by",label:"Booked by",render:x=>x.quote_booked_by||e.jsx("span",{children:"-"})},{key:"actions",label:"",render:x=>e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(x),className:"btn-view",children:e.jsx(G,{})}),e.jsx("button",{onClick:()=>s(x),className:"btn-edit",children:e.jsx(U,{})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"header-container",children:[e.jsx("div",{className:"header-container-left",children:e.jsx("div",{className:"header-actions",children:e.jsx("h1",{className:"page-heading",children:"Quotes"})})}),e.jsxs("div",{className:"search-container",children:[e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx(J,{className:"search-icon"}),e.jsx("input",{className:"search-bar",value:i,onChange:x=>m(x.target.value)})]}),e.jsx("button",{onClick:()=>f(!0),className:"send-email-button",disabled:p.length===0,children:e.jsx(K,{})}),e.jsx("button",{onClick:S,className:"delete-button",children:e.jsx(Z,{})})]})]}),b?e.jsx("div",{children:"Loading..."}):t.length===0?e.jsx("div",{children:"No records found"}):e.jsx(W,{data:N,headers:M.map(x=>({...x,label:T(x)})),handleSort:$,sortBy:d,sortDesc:h}),e.jsx(Q,{currentPage:E,totalPages:k,onPageChange:z}),e.jsx(F,{isOpen:v,onClose:()=>n(!1),title:"Edit Quote",children:r&&e.jsx(ie,{quote:r,onClose:()=>n(!1),onUpdate:I})}),e.jsx(F,{isOpen:y,onClose:()=>f(!1),title:"Send Email",children:e.jsx("button",{onClick:w,children:"Send"})}),e.jsx(F,{isOpen:l,onClose:()=>c(!1),title:"Quote Details",children:r&&e.jsx(me,{quote:r,onClose:()=>c(!1)})})]})},De=()=>e.jsx("div",{children:e.jsx(he,{})});export{De as default};
