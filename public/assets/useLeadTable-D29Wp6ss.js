import{r as s,b as x,S as l}from"./index-Cbvw9UaN.js";const A="https://linkloadsapiprod.onrender.com/api",J=()=>{const[w,u]=s.useState([]),[B,m]=s.useState(!0),[y,C]=s.useState(""),[c,b]=s.useState("created_at"),[d,E]=s.useState(!0),[f,L]=s.useState(1),[O,i]=s.useState(null),[k,g]=s.useState(!1),[I,$]=s.useState(!1),[D,h]=s.useState(!1),[a,n]=s.useState([]),[S,q]=s.useState(10),M=async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");m(!0);const{data:t}=await x.get(`${A}/lead`,{headers:{Authorization:`Bearer ${e}`}});u(t)}catch(e){console.error("Error loading leads:",e),N(e)}finally{m(!1)}};s.useEffect(()=>{M()},[]);const N=e=>{e.response&&e.response.status===401&&l.fire({icon:"error",title:"Unauthorized",text:"You need to log in to access this resource."})},T=e=>{L(e)},V=e=>{i(e),g(!0)},z=()=>{g(!1),i(null)},F=e=>{i(e),h(!0)},Q=()=>{h(!1),i(null)},R=e=>{u(t=>t.map(o=>o.id===e.id?{...o,...e}:o))},U=()=>{a.length===p.length?n([]):n(p.map(e=>e.id))},Y=e=>{n(t=>t.includes(e)?t.filter(o=>o!==e):[...t,e])},_=async()=>{if(a.length===0){l.fire({icon:"warning",title:"No record selected",text:"Please select a record to delete."});return}if((await l.fire({title:"Are you sure?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete selected!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");await Promise.all(a.map(o=>x.delete(`${A}/lead/${o}`,{headers:{Authorization:`Bearer ${t}`}}))),u(o=>o.filter(r=>!a.includes(r.id))),n([]),l.fire("Deleted!","Selected leads have been deleted.","success")}catch(t){console.error("Error deleting leads:",t),l.fire({icon:"error",title:"Error!",text:"Failed to delete selected leads."})}},j=e=>{c===e?E(!d):(b(e),E(!1))},P=w.filter(e=>Object.values(e).some(t=>t!=null&&t.toString().toLowerCase().includes(y.toLowerCase()))),p=P.sort((e,t)=>{let o=e[c]??"",r=t[c]??"";return typeof o=="string"&&typeof r=="string"?d?r.localeCompare(o):o.localeCompare(r):typeof o=="number"&&typeof r=="number"?d?r-o:o-r:0}).slice((f-1)*S,f*S),v=Math.ceil(P.length/S);return{fetchLeads:M,leads:w,loading:B,searchQuery:y,setSearchQuery:C,sortBy:c,sortDesc:d,selectedIds:a,setSelectedIds:n,paginatedData:p,totalPages:v,currentPage:f,setCurrentPage:L,isEditModalOpen:k,isAddModalOpen:I,isViewModalOpen:D,selectedLead:O,openEditModal:V,closeEditModal:z,openViewModal:F,closeViewModal:Q,setEditModalOpen:g,setAddModalOpen:$,setViewModalOpen:h,toggleSelectAll:U,toggleSelect:Y,deleteSelected:_,handleSort:j,updateLead:R,handlePageChange:T}};export{J as u};
