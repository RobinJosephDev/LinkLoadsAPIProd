import{r as y,j as e,b as F,S as P}from"./index-Dd33HN3-.js";import{R as M,a as H,b as ee,T as te,M as B}from"./Modal-mZ12kiPk.js";import{z as i,P as se}from"./Pagination-Cp7cgeW5.js";import W from"./purify.es-Ci5xwkH_.js";import{u as G}from"./useGoogleAutocomplete-CdP8wscP.js";/* empty css             */import{o as re,R as oe}from"./EyeOutlined-yrfy-ixN.js";import{R as ae}from"./MailOutlined-C0GPmh2k.js";const le=i.object({load_type:i.enum(["FTL","LTL"],{message:"Please select a valid load type"}),quote_booked_by:i.string().max(100,"Booked By cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]*$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed").optional(),quote_temperature:i.union([i.string().max(10,"Temperature cannot exceed 10 characters").regex(/^-?\d+(\.\d+)?\s?[°CFK]?$/,"Enter a valid temperature (e.g., 5°C, -10F, 273K)"),i.number()]).optional(),quote_customer:i.string().min(1,"Customer is required").max(200,"Customer name cannot exceed 200 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_cust_ref_no:i.string().min(1,"Customer Ref. No is required").max(100,"Customer Ref. No cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_hot:i.boolean().optional(),quote_team:i.boolean().optional(),quote_air_ride:i.boolean().optional(),quote_tarp:i.boolean().optional(),quote_hazmat:i.boolean().optional()}),ne=[{key:"quote_booked_by",label:"Booked By",placeholder:"Enter Person Who Booked",type:"text"},{key:"quote_temperature",label:"Temperature",placeholder:"Enter Required Temperature",type:"text"},{key:"quote_hot",label:"Hot",type:"boolean"},{key:"quote_team",label:"Team",type:"boolean"},{key:"quote_air_ride",label:"Air Ride",type:"boolean"},{key:"quote_tarp",label:"TARP",type:"boolean"},{key:"quote_hazmat",label:"Hazmat",type:"boolean"}],ie=({formQuote:t,setFormQuote:b})=>{const[l,d]=y.useState({}),[c,g]=y.useState([]),[p,h]=y.useState([]),_=["FTL","LTL"],C="https://linkloadsapiprod.onrender.com/api";y.useEffect(()=>{(async()=>{try{const m=localStorage.getItem("token"),a=await F.get(`${C}/customer`,{headers:{Authorization:`Bearer ${m}`}});if(!a||!a.data){console.error("API response is undefined or invalid:",a);return}console.log("Fetched customers:",a.data);const r=a.data.map(o=>({value:o.cust_name,label:o.cust_name,refNo:o.cust_ref_no}));g(r)}catch(m){console.error("Error fetching customers:",m)}})()},[]),y.useEffect(()=>{if(t.quote_customer){const s=c.find(m=>m.value===t.quote_customer);h(s?[{value:s.refNo,label:s.refNo}]:[])}else h([])},[t.quote_customer,c]);const f=(s,m)=>{let a=m,r="";const o={...t,[s]:a},n=le.safeParse(o);if(!n.success){const u=n.error.errors.find(q=>q.path[0]===s);r=u?u.message:""}d(u=>({...u,[s]:r})),b(o)};return e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"equipment",children:["Load Type ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"equipment",value:t.quote_type,onChange:s=>b(m=>({...m,quote_type:s.target.value})),children:[e.jsx("option",{value:"",disabled:!0,children:"Select..."}),_.map(s=>e.jsx("option",{value:s,children:s},s))]}),l.quote_type&&e.jsx("span",{className:"error",style:{color:"red"},children:l.quote_type})]}),e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"customer",children:["Customer ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer",value:t.quote_customer||"",onChange:s=>f("quote_customer",s.target.value),onBlur:()=>f("quote_customer",t.quote_customer||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a customer"}),c.length>0?c.map((s,m)=>e.jsx("option",{value:s.value,children:s.label},`${s.refNo}-${m}`)):e.jsx("option",{disabled:!0,children:"No customers found"})]}),l.customer&&e.jsx("span",{className:"error",style:{color:"red"},children:l.customer})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsxs("label",{htmlFor:"customerRefNo",children:["Customer Ref. No ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer_ref_no",value:t.quote_cust_ref_no||"",onChange:s=>f("quote_cust_ref_no",s.target.value),onBlur:()=>f("quote_cust_ref_no",t.quote_cust_ref_no||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reference number"}),p.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),l.customer_ref_no&&e.jsx("span",{className:"error",style:{color:"red"},children:l.customer_ref_no})]}),ne.map(({key:s,label:m,placeholder:a,type:r})=>e.jsx("div",{children:e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[r==="boolean"?e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",id:s,checked:!!t[s],onChange:o=>f(s,o.target.checked),style:{transform:"scale(1.1)",cursor:"pointer",margin:0}}),e.jsx("label",{htmlFor:s,style:{margin:0,whiteSpace:"nowrap"},children:m})]}):e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsx("label",{htmlFor:s,children:m})," ",e.jsx("input",{type:"text",id:s,placeholder:a,value:String(t[s]||""),onChange:o=>f(s,o.target.value)})]}),l[s]&&e.jsx("span",{className:"error",style:{color:"red"},children:l[s]})]},s)},s))]})]})},Y=i.object({address:i.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:i.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:i.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:i.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:i.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:i.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:i.string().regex(/^\d{2}-\d{2}-\d{4}$/,{message:"Date must be in DD-MM-YYYY format"}).optional(),time:i.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:i.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:i.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),pickup_po:i.string().max(100,"Pickup PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid pickup PO format").optional(),packages:i.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:i.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:i.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:i.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),J=({setQuote:t,quote_pickup:b,index:l,handlePickupChange:d,handleRemovePickup:c,onAddPickup:g})=>{const p=b[l]??{},[h,_]=y.useState({}),f=G(a=>{const r=o=>{var n,u;return((u=(n=a.address_components)==null?void 0:n.find(q=>q.types.includes(o)))==null?void 0:u.long_name)||""};t(o=>({...o,quote_pickup:o.quote_pickup.map((n,u)=>u===l?{...n,address:`${r("street_number")} ${r("route")}`.trim(),city:r("locality"),state:r("administrative_area_level_1"),country:r("country"),postal:r("postal_code")}:n)}))}),s=y.useCallback((a,r)=>{const o=W.sanitize(r);if(a==="length"||a==="breadth"||a==="height"){const v=(p.dimensions||"").split("x");let[N="",$="",T=""]=v;a==="length"&&(N=o),a==="breadth"&&($=o),a==="height"&&(T=o);const I=[N,$,T].filter(Boolean).join("x"),D={...p,dimensions:I},w=Y.safeParse(D);let R="";if(!w.success){const E=w.error.errors.find(O=>O.path[0]==="dimensions");R=E?E.message:""}_(E=>({...E,dimensions:R})),d(l,D);return}let n=o;(a==="packages"||a==="weight")&&(n=o?Number(o):0);let u="";const q={...p,[a]:n},S=Y.safeParse(q);if(!S.success){const v=S.error.errors.find(N=>N.path[0]===a);u=v?v.message:""}_(v=>({...v,[a]:u})),d(l,q)},[origin,d,l]),m=[{label:"Address",key:"address",type:"text",placeholder:"Enter street address"},{label:"City",key:"city",type:"text",placeholder:"Enter city name"},{label:"State",key:"state",type:"text",placeholder:"Enter state"},{label:"Country",key:"country",type:"text",placeholder:"Enter country"},{label:"Postal Code",key:"postal",type:"text",placeholder:"Enter postal code"},{label:"Phone",key:"phone",type:"text",placeholder:"Enter phone number"},{label:"Date",key:"date",type:"date"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",type:"text",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",type:"text",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",type:"text",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",type:"number",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",type:"number",placeholder:"Enter weight (kg/lbs)"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:[m.map(({label:a,key:r,type:o,placeholder:n})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${r}-${l}`,children:a}),e.jsx("input",{id:`${r}-${l}`,name:r,type:o,value:p[r]||"",onChange:u=>s(r,u.target.value),placeholder:n,ref:r==="address"?f:void 0}),h[r]&&e.jsx("span",{className:"error",style:{color:"red"},children:h[r]})]},r)),(()=>{const[a="",r="",o=""]=(p.dimensions||"").split("x");return e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{children:"Dimensions"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{id:`length-${l}`,name:"length",type:"number",value:a,onChange:n=>s("length",n.target.value),placeholder:"L",style:{flex:1}}),e.jsx("input",{id:`breadth-${l}`,name:"breadth",type:"number",value:r,onChange:n=>s("breadth",n.target.value),placeholder:"B",style:{flex:1}}),e.jsx("input",{id:`height-${l}`,name:"height",type:"number",value:o,onChange:n=>s("height",n.target.value),placeholder:"H",style:{flex:1}})]}),h.dimensions&&e.jsx("span",{className:"error",style:{color:"red"},children:h.dimensions})]})})(),e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`notes-${l}`,children:"Notes"}),e.jsx("textarea",{id:`notes-${l}`,name:"notes",value:p.notes||"",onChange:a=>s("notes",a.target.value),placeholder:"Enter additional notes",rows:4}),h.notes&&e.jsx("span",{className:"error",style:{color:"red"},children:h.notes})]})]}),e.jsxs("div",{className:"action-buttons-column",style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:g,className:"add-btn",children:e.jsx(M,{})}),e.jsx("button",{type:"button",onClick:()=>c(l),className:"delete-button",children:e.jsx(H,{})})]})]})},U=i.object({address:i.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:i.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:i.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:i.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:i.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:i.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:i.string().regex(/^\d{2}-\d{2}-\d{4}$/,{message:"Date must be in DD-MM-YYYY format"}).optional(),time:i.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:i.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:i.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),delivery_po:i.string().max(100,"Delivery PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid delivery PO format").optional(),packages:i.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:i.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:i.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:i.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),K=({setQuote:t,quote_delivery:b,index:l,handleDeliveryChange:d,handleRemoveDelivery:c,onAddDelivery:g})=>{const p=b[l]??{},[h,_]=y.useState({}),f=G(a=>{const r=o=>{var n,u;return((u=(n=a.address_components)==null?void 0:n.find(q=>q.types.includes(o)))==null?void 0:u.long_name)||""};t(o=>({...o,quote_delivery:o.quote_delivery.map((n,u)=>u===l?{...n,address:`${r("street_number")} ${r("route")}`.trim(),city:r("locality"),state:r("administrative_area_level_1"),country:r("country"),postal:r("postal_code")}:n)}))}),s=y.useCallback((a,r)=>{const o=W.sanitize(r);if(a==="length"||a==="breadth"||a==="height"){const v=(p.dimensions||"").split("x");let[N="",$="",T=""]=v;a==="length"&&(N=o),a==="breadth"&&($=o),a==="height"&&(T=o);const I=[N,$,T].filter(Boolean).join("x"),D={...p,dimensions:I},w=U.safeParse(D);let R="";if(!w.success){const E=w.error.errors.find(O=>O.path[0]==="dimensions");R=E?E.message:""}_(E=>({...E,dimensions:R})),d(l,D);return}let n=o;(a==="packages"||a==="weight")&&(n=o?Number(o):0);let u="";const q={...p,[a]:n},S=U.safeParse(q);if(!S.success){const v=S.error.errors.find(N=>N.path[0]===a);u=v?v.message:""}_(v=>({...v,[a]:u})),d(l,q)},[origin,d,l]),m=[{label:"Address",key:"address",type:"text",placeholder:"Enter street address"},{label:"City",key:"city",type:"text",placeholder:"Enter city name"},{label:"State",key:"state",type:"text",placeholder:"Enter state"},{label:"Country",key:"country",type:"text",placeholder:"Enter country"},{label:"Postal Code",key:"postal",type:"text",placeholder:"Enter postal code"},{label:"Phone",key:"phone",type:"text",placeholder:"Enter phone number"},{label:"Date",key:"date",type:"date",placeholder:"Enter date (YYYY-MM-DD)"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",type:"text",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",type:"text",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",type:"text",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",type:"number",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",type:"number",placeholder:"Enter weight (kg/lbs)"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:[m.map(({label:a,key:r,type:o,placeholder:n})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${r}-${l}`,children:a}),e.jsx("input",{id:`${r}-${l}`,name:r,type:o,value:p[r]||"",onChange:u=>s(r,u.target.value),placeholder:n,ref:r==="address"?f:void 0}),h[r]&&e.jsx("span",{className:"error",style:{color:"red"},children:h[r]})]},r)),(()=>{const[a="",r="",o=""]=(p.dimensions||"").split("x");return e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{children:"Dimensions"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{id:`length-${l}`,name:"length",type:"number",value:a,onChange:n=>s("length",n.target.value),placeholder:"L",style:{flex:1}}),e.jsx("input",{id:`breadth-${l}`,name:"breadth",type:"number",value:r,onChange:n=>s("breadth",n.target.value),placeholder:"B",style:{flex:1}}),e.jsx("input",{id:`height-${l}`,name:"height",type:"number",value:o,onChange:n=>s("height",n.target.value),placeholder:"H",style:{flex:1}})]}),h.dimensions&&e.jsx("span",{className:"error",style:{color:"red"},children:h.dimensions})]})})(),e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`notes-${l}`,children:"Notes"}),e.jsx("textarea",{id:`notes-${l}`,name:"notes",value:p.notes||"",onChange:a=>s("notes",a.target.value),placeholder:"Enter additional notes",rows:4}),h.notes&&e.jsx("span",{className:"error",style:{color:"red"},children:h.notes})]})]}),e.jsxs("div",{className:"action-buttons-column",style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:g,className:"add-btn",children:e.jsx(M,{})}),e.jsx("button",{type:"button",onClick:()=>c(l),className:"delete-button",children:e.jsx(H,{})})]})]})},ce="https://linkloadsapiprod.onrender.com/api",de=(t,b,l)=>{const[d,c]=y.useState({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""});y.useEffect(()=>{if(t){const a=Array.isArray(t.quote_pickup)?t.quote_pickup:JSON.parse(t.quote_pickup||"[]"),r=Array.isArray(t.quote_delivery)?t.quote_delivery:JSON.parse(t.quote_delivery||"[]"),o={...t,quote_pickup:a.length>0?a:[],quote_delivery:r.length>0?r:[]};c(o)}},[t]);const g=()=>!!d.quote_type&&!!d.quote_customer&&!!d.quote_cust_ref_no;return{formQuote:d,setFormQuote:c,updateQuote:async()=>{var a,r;if(!g()){P.fire("Validation Error","Please fill in all required fields.","error");return}try{const o=localStorage.getItem("token");if(!o||typeof o!="string"){P.fire({icon:"error",title:"Unauthorized",text:"Please log in again."});return}const n=await F.put(`${ce}/quote/${d.id}`,d,{headers:{Authorization:`Bearer ${o}`}});P.fire({icon:"success",title:"Updated!",text:"Quote updated successfully."}),l(n.data),b()}catch(o){console.error("Error updating quote:",((a=o.response)==null?void 0:a.data)||o.message),P.fire({icon:"error",title:"Oops...",text:((r=o.response)==null?void 0:r.status)===401?"Unauthorized. Please log in again.":"Failed to update quote."})}},handleAddPickup:()=>{c(a=>a&&{...a,quote_pickup:[...a.quote_pickup,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]})},handleRemovePickup:a=>{c(r=>r&&{...r,quote_pickup:r.quote_pickup.filter((o,n)=>n!==a)})},handlePickupChange:(a,r)=>{c(o=>o&&{...o,quote_pickup:o.quote_pickup.map((n,u)=>u===a?r:n)})},handleAddDelivery:()=>{c(a=>a&&{...a,quote_delivery:[...a.quote_delivery,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]})},handleRemoveDelivery:a=>{c(r=>r&&{...r,quote_delivery:r.quote_delivery.filter((o,n)=>n!==a)})},handleDeliveryChange:(a,r)=>{c(o=>o&&{...o,quote_delivery:o.quote_delivery.map((n,u)=>u===a?r:n)})}}},ue=({quote:t,onClose:b,onUpdate:l})=>{var m;const{formQuote:d,setFormQuote:c,updateQuote:g,handleAddPickup:p,handleRemovePickup:h,handlePickupChange:_,handleAddDelivery:C,handleRemoveDelivery:f,handleDeliveryChange:s}=de(t,b,l);return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:a=>{a.preventDefault(),g()},className:"form-main",children:[d&&e.jsxs(e.Fragment,{children:[e.jsx(ie,{formQuote:d,setFormQuote:c}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Origin"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[(m=d.quote_pickup)==null?void 0:m.map((a,r)=>e.jsx(J,{quote:d,setQuote:c,quote_pickup:d.quote_pickup,index:r,onAddPickup:p,handlePickupChange:_,handleRemovePickup:h},r)),d.quote_pickup.length===0&&e.jsx("button",{type:"button",onClick:p,className:"add-btn",children:e.jsx(M,{})})]})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Destination"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[d.quote_delivery.map((a,r)=>e.jsx(K,{quote:d,setQuote:c,quote_delivery:d.quote_delivery,index:r,onAddDelivery:C,handleDeliveryChange:s,handleRemoveDelivery:f},r)),d.quote_delivery.length===0&&e.jsx("button",{type:"button",onClick:C,className:"add-btn",children:e.jsx(M,{})})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-submit",children:"Save"}),e.jsx("button",{type:"button",className:"btn-cancel",onClick:b,children:"Cancel"})]})]})})},me=({formQuote:t})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"quoteType",children:"Quote Type"}),e.jsx("div",{children:t.quote_type||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"quote_customer",children:"Customer"}),e.jsx("div",{children:t.quote_customer||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"customerRefNo",children:"Customer Ref. No"}),e.jsx("div",{children:t.quote_cust_ref_no||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"accNo",children:"Booked By"}),e.jsx("div",{children:t.quote_booked_by||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"branch",children:"Temperature"}),e.jsx("div",{children:t.quote_temperature||"N/A"})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Hot",style:{display:"block"},children:"Hot"}),e.jsx("span",{children:t.quote_hot?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Team",style:{display:"block"},children:"Team"}),e.jsx("span",{children:t.quote_team?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Air Ride",style:{display:"block"},children:"Air Ride"}),e.jsx("span",{children:t.quote_air_ride?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"TARP",style:{display:"block"},children:"TARP"}),e.jsx("span",{children:t.quote_tarp?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Hazmat",style:{display:"block"},children:"Hazmat"}),e.jsx("span",{children:t.quote_hazmat?"Yes":"No"})]})]})]}),pe=({delivery:t})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Address"}),e.jsx("div",{children:t.address||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"City"}),e.jsx("div",{children:t.city||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"State"}),e.jsx("div",{children:t.state||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Postal Code"}),e.jsx("div",{children:t.postal||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:t.country||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Date"}),e.jsx("div",{children:t.date||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Time"}),e.jsx("div",{children:t.time||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Currency"}),e.jsx("div",{children:t.currency||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Equipment"}),e.jsx("div",{children:t.equipment||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Pickup PO"}),e.jsx("div",{children:t.pickup_po||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Phone"}),e.jsx("div",{children:t.phone||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Packages"}),e.jsx("div",{children:t.packages||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Weight"}),e.jsx("div",{children:t.weight||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Dimensions"}),e.jsx("div",{children:t.dimensions||""})]})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Notes"}),e.jsx("div",{children:t.notes||""})]})]}),he=({pickup:t})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Address"}),e.jsx("div",{children:t.address||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"City"}),e.jsx("div",{children:t.city||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"State"}),e.jsx("div",{children:t.state||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Postal Code"}),e.jsx("div",{children:t.postal||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:t.country||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Date"}),e.jsx("div",{children:t.date||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Time"}),e.jsx("div",{children:t.time||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Currency"}),e.jsx("div",{children:t.currency||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Equipment"}),e.jsx("div",{children:t.equipment||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Pickup PO"}),e.jsx("div",{children:t.pickup_po||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Phone"}),e.jsx("div",{children:t.phone||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Packages"}),e.jsx("div",{children:t.packages||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Weight"}),e.jsx("div",{children:t.weight||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Dimensions"}),e.jsx("div",{children:t.dimensions||""})]})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Notes"}),e.jsx("div",{children:t.notes||""})]})]}),xe=({quote:t,onClose:b})=>{const[l,d]=y.useState({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""});return y.useEffect(()=>{if(console.log("quote:",t),console.log("quote_pickup:",t==null?void 0:t.quote_pickup),t){let c=[],g=[];if(Array.isArray(t.quote_pickup))c=t.quote_pickup;else if(typeof t.quote_pickup=="string")try{c=JSON.parse(t.quote_pickup),Array.isArray(c)||(c=[])}catch(p){console.error("Failed to parse quote_pickup:",p),c=[]}if(Array.isArray(t.quote_delivery))g=t.quote_delivery;else if(typeof t.quote_delivery=="string")try{g=JSON.parse(t.quote_delivery),Array.isArray(g)||(g=[])}catch(p){console.error("Failed to parse quote_delivery:",p),g=[]}d({...t,quote_pickup:c,quote_delivery:g})}},[t]),e.jsx("div",{className:"form-container",children:e.jsxs("form",{className:"form-main",children:[e.jsx(me,{formQuote:l}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Pickup"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:l.quote_pickup.map((c,g)=>e.jsx(he,{pickup:c,index:g},g))})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Delivery"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:l.quote_delivery.map((c,g)=>e.jsx(pe,{delivery:c,index:g},g))})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"button",className:"btn-cancel",onClick:b,style:{padding:"9px 15px"},children:"Cancel"})})]})})},V="https://linkloadsapiprod.onrender.com/api",ge=()=>{const[t,b]=y.useState([]),[l,d]=y.useState(!0),[c,g]=y.useState(""),[p,h]=y.useState("created_at"),[_,C]=y.useState(!0),[f,s]=y.useState(1),[m,a]=y.useState(null),[r,o]=y.useState(!1),[n,u]=y.useState(!1),[q,S]=y.useState(!1),[v,N]=y.useState([]),[$,T]=y.useState(10),[I,D]=y.useState(!1),[w,R]=y.useState({subject:"",content:""}),E=async()=>{try{const x=localStorage.getItem("token");if(!x)throw new Error("No token found");d(!0);const{data:k}=await F.get(`${V}/quote`,{headers:{Authorization:`Bearer ${x}`}});b(k)}catch(x){console.error("Error loading quotes:",x),O(x)}finally{d(!1)}};y.useEffect(()=>{E()},[]);const O=x=>{x.response&&x.response.status===401&&P.fire({icon:"error",title:"Unauthorized",text:"You need to log in to access this resource."})},L=x=>{p===x?C(!_):(h(x),C(!1))},j=t.filter(x=>Object.values(x).some(k=>k==null?void 0:k.toString().toLowerCase().includes(c.toLowerCase()))),Z=j.sort((x,k)=>{let A=x[p]??"",z=k[p]??"";return typeof A=="string"&&typeof z=="string"?_?z.localeCompare(A):A.localeCompare(z):typeof A=="number"&&typeof z=="number"?_?z-A:A-z:0}).slice((f-1)*$,f*$),X=Math.ceil(j.length/$);return{fetchQuotes:E,quotes:t,loading:l,searchQuery:c,setSearchQuery:g,sortBy:p,sortDesc:_,selectedIds:v,setSelectedIds:N,paginatedData:Z,totalPages:X,currentPage:f,setCurrentPage:s,isEditModalOpen:r,isAddModalOpen:n,isViewModalOpen:q,isEmailModalOpen:I,selectedQuote:m,openEditModal:x=>{a(x),o(!0)},closeEditModal:()=>{o(!1),a(null)},openViewModal:x=>{a(x),S(!0)},closeViewModal:()=>{S(!1),a(null)},setEditModalOpen:o,setAddModalOpen:u,setViewModalOpen:S,setEmailModalOpen:D,toggleSelectAll:()=>{v.length===Z.length?N([]):N(Z.map(x=>x.id))},toggleSelect:x=>{N(k=>k.includes(x)?k.filter(A=>A!==x):[...k,x])},deleteSelected:async()=>{if(v.length===0){P.fire({icon:"warning",title:"No record selected",text:"Please select a record to delete."});return}if((await P.fire({title:"Are you sure?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete selected!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const k=localStorage.getItem("token");if(!k)throw new Error("No token found");await Promise.all(v.map(A=>F.delete(`${V}/quote/${A}`,{headers:{Authorization:`Bearer ${k}`}}))),b(A=>A.filter(z=>!v.includes(z.id))),N([]),P.fire("Deleted!","Selected quotes have been deleted.","success")}catch(k){console.error("Error deleting quotes:",k),P.fire({icon:"error",title:"Error!",text:"Failed to delete selected quotes."})}},emailData:w,setEmailData:R,sendEmails:async()=>{if(v.length===0){P.fire({icon:"warning",title:"No quotes selected",text:"Please select quotes to send emails to."});return}try{const x=localStorage.getItem("token");if(!x)throw new Error("No token found");await F.post(`${V}/email`,{ids:v,...w,module:"quotes"},{headers:{Authorization:`Bearer ${x}`,"Content-Type":"application/json"}}),P.fire("Success!","Emails have been sent.","success"),D(!1),N([])}catch(x){console.error("Error sending emails:",x),P.fire("Error!","Failed to send emails.","error")}},handleSort:L,updateQuote:x=>{b(k=>k.map(A=>A.id===x.id?{...A,...x}:A))},handlePageChange:x=>{s(x)}}},ye=i.object({load_type:i.enum(["FTL","LTL"],{message:"Please select a valid load type"}),quote_booked_by:i.string().max(100,"Booked By cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]*$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed").optional(),quote_temperature:i.union([i.string().max(10,"Temperature cannot exceed 10 characters").regex(/^-?\d+(\.\d+)?\s?[°CFK]?$/,"Enter a valid temperature (e.g., 5°C, -10F, 273K)"),i.number()]).optional(),quote_customer:i.string().min(1,"Customer is required").max(200,"Customer name cannot exceed 200 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_cust_ref_no:i.string().min(1,"Customer Ref. No is required").max(100,"Customer Ref. No cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_hot:i.boolean().optional(),quote_team:i.boolean().optional(),quote_air_ride:i.boolean().optional(),quote_tarp:i.boolean().optional(),quote_hazmat:i.boolean().optional()}),fe=[{key:"quote_booked_by",label:"Booked By",placeholder:"Enter Person Who Booked",type:"text"},{key:"quote_temperature",label:"Temperature",placeholder:"Enter Required Temperature",type:"text"},{key:"quote_hot",label:"Hot",type:"boolean"},{key:"quote_team",label:"Team",type:"boolean"},{key:"quote_air_ride",label:"Air Ride",type:"boolean"},{key:"quote_tarp",label:"TARP",type:"boolean"},{key:"quote_hazmat",label:"Hazmat",type:"boolean"}],je=({quote:t,setQuote:b})=>{const[l,d]=y.useState({}),[c,g]=y.useState([]),[p,h]=y.useState([]),_=["FTL","LTL"],C="https://linkloadsapiprod.onrender.com/api";y.useEffect(()=>{(async()=>{try{const m=localStorage.getItem("token"),a=await F.get(`${C}/customer`,{headers:{Authorization:`Bearer ${m}`}});if(!a||!a.data){console.error("API response is undefined or invalid:",a);return}console.log("Fetched customers:",a.data);const r=a.data.map(o=>({value:o.cust_name,label:o.cust_name,refNo:o.cust_ref_no}));g(r)}catch(m){console.error("Error fetching customers:",m)}})()},[]),y.useEffect(()=>{if(t.quote_customer){const s=c.find(m=>m.value===t.quote_customer);h(s?[{value:s.refNo,label:s.refNo}]:[])}else h([])},[t.quote_customer,c]);const f=(s,m)=>{let a=m,r="";const o={...t,[s]:a},n=ye.safeParse(o);if(!n.success){const u=n.error.errors.find(q=>q.path[0]===s);r=u?u.message:""}d(u=>({...u,[s]:r})),b(o)};return e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"equipment",children:["Load Type ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"equipment",value:t.quote_type,onChange:s=>b(m=>({...m,quote_type:s.target.value})),children:[e.jsx("option",{value:"",children:"Select..."}),_.map(s=>e.jsx("option",{value:s,children:s},s))]}),l.quote_type&&e.jsx("span",{className:"error",style:{color:"red"},children:l.quote_type})]}),e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"customer",children:["Customer ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer",value:t.quote_customer||"",onChange:s=>f("quote_customer",s.target.value),onBlur:()=>f("quote_customer",t.quote_customer||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a customer"}),c.length>0?c.map((s,m)=>e.jsx("option",{value:s.value,children:s.label},`${s.refNo}-${m}`)):e.jsx("option",{disabled:!0,children:"No customers found"})]}),l.customer&&e.jsx("span",{className:"error",style:{color:"red"},children:l.customer})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsxs("label",{htmlFor:"customerRefNo",children:["Customer Ref. No ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer_ref_no",value:t.quote_cust_ref_no||"",onChange:s=>f("quote_cust_ref_no",s.target.value),onBlur:()=>f("quote_cust_ref_no",t.quote_cust_ref_no||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reference number"}),p.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),l.customer_ref_no&&e.jsx("span",{className:"error",style:{color:"red"},children:l.customer_ref_no})]}),fe.map(({key:s,label:m,placeholder:a,type:r})=>e.jsx("div",{children:e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[r==="boolean"?e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",id:s,checked:!!t[s],onChange:o=>f(s,o.target.checked),style:{transform:"scale(1.1)",cursor:"pointer",margin:0}}),e.jsx("label",{htmlFor:s,style:{margin:0,whiteSpace:"nowrap"},children:m})]}):e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsx("label",{htmlFor:s,children:m})," ",e.jsx("input",{type:"text",id:s,placeholder:a,value:String(t[s]||""),onChange:o=>f(s,o.target.value)})]}),l[s]&&e.jsx("span",{className:"error",style:{color:"red"},children:l[s]})]},s)},s))]})]})},Q="https://linkloadsapiprod.onrender.com/api",be=(t,b)=>{const l={id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""},[d,c]=y.useState(l),g=()=>!!d.quote_type&&!!d.quote_customer,p=async r=>{if(r.preventDefault(),!g()){P.fire("Validation Error","Please fill in all required fields.","error");return}try{const o=localStorage.getItem("token");if(!o){P.fire("Error","No token found","error");return}const n={Authorization:`Bearer ${o}`},u=d.id?await F.put(`${Q}/quote/${d.id}`,d,{headers:n}):await F.post(`${Q}/quote`,d,{headers:n});P.fire(d.id?"Success!":"Saved!","Quote created successfully.","success"),h(),b()}catch(o){console.error("Error saving/updating quote:",o.response?o.response.data:o.message),P.fire("Error","An error occurred while processing the quote.","error")}},h=()=>{c({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""})};return{quote:d,setQuote:c,handleSubmit:p,clearQuoteForm:h,handleAddPickup:()=>{c(r=>({...r,quote_pickup:[...r.quote_pickup,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]}))},handlePickupChange:(r,o)=>{const n=d.quote_pickup.map((u,q)=>q===r?o:u);c(u=>({...u,quote_pickup:n}))},handleRemovePickup:r=>{c(o=>({...o,quote_pickup:o.quote_pickup.filter((n,u)=>u!==r)}))},handleAddDelivery:()=>{c(r=>({...r,quote_delivery:[...r.quote_delivery,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]}))},handleDeliveryChange:(r,o)=>{const n=d.quote_delivery.map((u,q)=>q===r?o:u);c(u=>({...u,quote_delivery:n}))},handleRemoveDelivery:r=>{c(o=>({...o,quote_delivery:o.quote_delivery.filter((n,u)=>u!==r)}))}}},_e=({onClose:t,onSuccess:b})=>{const{quote:l,setQuote:d,handleSubmit:c,handleAddPickup:g,handlePickupChange:p,handleRemovePickup:h,handleAddDelivery:_,handleDeliveryChange:C,handleRemoveDelivery:f}=be(t,b);return e.jsx("div",{className:"form-container",children:e.jsx("form",{onSubmit:c,className:"form-main",children:e.jsxs("div",{className:"submit-button-container",children:[e.jsx(je,{quote:l,setQuote:d}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Pickup"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:l.quote_pickup.map((s,m)=>e.jsx(J,{quote:l,setQuote:d,quote_pickup:l.quote_pickup,index:m,onAddPickup:g,handlePickupChange:p,handleRemovePickup:h},m))}),l.quote_pickup.length===0&&e.jsx("button",{type:"button",onClick:g,className:"add-btn",children:e.jsx(M,{})})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Delivery"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:l.quote_delivery.map((s,m)=>e.jsx(K,{quote:l,setQuote:d,quote_delivery:l.quote_delivery,index:m,onAddDelivery:_,handleDeliveryChange:C,handleRemoveDelivery:f},m))}),l.quote_delivery.length===0&&e.jsx("button",{type:"button",onClick:_,className:"add-btn",children:e.jsx(M,{})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-submit",children:"Create Quote"}),e.jsx("button",{type:"button",className:"btn-cancel",onClick:t,children:"Cancel"})]})]})})})},ve=()=>{const{fetchQuotes:t,quotes:b,loading:l,searchQuery:d,setSearchQuery:c,sortBy:g,sortDesc:p,selectedIds:h,paginatedData:_,totalPages:C,currentPage:f,isEditModalOpen:s,isAddModalOpen:m,isViewModalOpen:a,isEmailModalOpen:r,selectedQuote:o,openEditModal:n,closeEditModal:u,openViewModal:q,closeViewModal:S,setAddModalOpen:v,setEmailModalOpen:N,toggleSelectAll:$,toggleSelect:T,deleteSelected:I,sendEmails:D,handleSort:w,updateQuote:R,handlePageChange:E}=ge(),O=j=>j.key==="checkbox"||j.key==="actions"?j.label:e.jsxs("div",{className:"sortable-header",onClick:()=>w(j.key),children:[j.label,e.jsx("span",{className:"sort-icon",children:g===j.key?p?"▼":"▲":"▼"})]}),L=[{key:"checkbox",label:e.jsx("input",{type:"checkbox",checked:h.length===_.length&&_.length>0,onChange:$}),render:j=>e.jsx("input",{type:"checkbox",checked:h.includes(j.id),onChange:()=>T(j.id)})},{key:"quote_customer",label:"Customer",render:j=>j.quote_customer||e.jsx("span",{children:"-"})},{key:"quote_cust_ref_no",label:"Customer Ref#",render:j=>j.quote_cust_ref_no||e.jsx("span",{children:"-"})},{key:"quote_type",label:"Type",render:j=>j.quote_type||e.jsx("span",{children:"-"})},{key:"quote_booked_by",label:"Booked by",render:j=>j.quote_booked_by||e.jsx("span",{children:"-"})},{key:"actions",label:"Actions",render:j=>e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>q(j),className:"btn-view",children:e.jsx(re,{})}),e.jsx("button",{onClick:()=>n(j),className:"btn-edit",children:e.jsx(ee,{})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"header-container",children:[e.jsx("div",{className:"header-container-left",children:e.jsx("div",{className:"header-actions",children:e.jsx("h1",{className:"page-heading",children:"Quotes"})})}),e.jsxs("div",{className:"search-container",children:[e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx(oe,{className:"search-icon"}),e.jsx("input",{className:"search-bar",value:d,onChange:j=>c(j.target.value)})]}),e.jsxs("button",{onClick:()=>v(!0),className:"add-button",children:[e.jsx(M,{})," New"]})]})]}),h.length>0&&e.jsxs("div",{className:"selection-banner",children:[e.jsxs("span",{children:[h.length," item",h.length>1?"s":""," selected"]}),e.jsxs("button",{onClick:()=>N(!0),className:"send-email-button",disabled:h.length===0,children:[e.jsx(ae,{}),"  Send Email"]}),e.jsxs("button",{className:"text-delete-btn",onClick:I,children:[e.jsx(H,{}),"  Delete"]})]}),l?e.jsx("div",{children:"Loading..."}):b.length===0?e.jsx("div",{children:"No records found"}):e.jsx(te,{data:_,headers:L.map(j=>({...j,label:O(j)})),handleSort:w,sortBy:g,sortDesc:p}),e.jsx(se,{currentPage:f,totalPages:C,onPageChange:E}),e.jsx(B,{isOpen:m,onClose:()=>v(!1),title:"Add Quote",children:e.jsx(_e,{onClose:()=>v(!1),onSuccess:t})}),e.jsx(B,{isOpen:s,onClose:u,title:"Edit Quote",children:o?e.jsx(ue,{quote:o,onClose:u,onUpdate:R}):e.jsx("p",{children:"No quote selected for editing."})}),e.jsx(B,{isOpen:r,onClose:()=>N(!1),title:"Send Email",children:e.jsx("button",{onClick:D,children:"Send"})}),e.jsx(B,{isOpen:a,onClose:S,title:"Quote Details",children:o&&e.jsx(xe,{quote:o,onClose:S})})]})},Le=()=>e.jsx("div",{children:e.jsx(ve,{})});export{Le as default};
