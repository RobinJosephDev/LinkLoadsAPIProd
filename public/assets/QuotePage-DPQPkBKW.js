import{r as x,j as e,b as D,S as P}from"./index-DLyAIf-h.js";import{R as $,a as z,b as G,T as J,M}from"./Modal-DtI_D4zj.js";import{z as l,P as K}from"./Pagination-DfY4bufF.js";import F from"./purify.es-Ci5xwkH_.js";import{u as O}from"./useGoogleAutocomplete-BW9foyuU.js";/* empty css             */import{o as X,R as ee}from"./EyeOutlined-CQEGpqEu.js";import{R as te}from"./MailOutlined-Cb2dQHic.js";const se=l.object({load_type:l.enum(["FTL","LTL"],{message:"Please select a valid load type"}),quote_booked_by:l.string().max(100,"Booked By cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]*$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed").optional(),quote_temperature:l.union([l.string().max(10,"Temperature cannot exceed 10 characters").regex(/^-?\d+(\.\d+)?\s?[°CFK]?$/,"Enter a valid temperature (e.g., 5°C, -10F, 273K)"),l.number()]).optional(),quote_customer:l.string().min(1,"Customer is required").max(200,"Customer name cannot exceed 200 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_cust_ref_no:l.string().min(1,"Customer Ref. No is required").max(100,"Customer Ref. No cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_hot:l.boolean().optional(),quote_team:l.boolean().optional(),quote_air_ride:l.boolean().optional(),quote_tarp:l.boolean().optional(),quote_hazmat:l.boolean().optional()}),ae=[{key:"quote_booked_by",label:"Booked By",placeholder:"Enter Person Who Booked",type:"text"},{key:"quote_temperature",label:"Temperature",placeholder:"Enter Required Temperature",type:"text"},{key:"quote_hot",label:"Hot",type:"boolean"},{key:"quote_team",label:"Team",type:"boolean"},{key:"quote_air_ride",label:"Air Ride",type:"boolean"},{key:"quote_tarp",label:"TARP",type:"boolean"},{key:"quote_hazmat",label:"Hazmat",type:"boolean"}],re=({formQuote:a,setFormQuote:_})=>{const[n,d]=x.useState({}),[u,h]=x.useState([]),[p,f]=x.useState([]),q=["FTL","LTL"],k="https://linkloadsapiprod.onrender.com/api";x.useEffect(()=>{(async()=>{try{const m=localStorage.getItem("token"),r=await D.get(`${k}/customer`,{headers:{Authorization:`Bearer ${m}`}});if(!r||!r.data){console.error("API response is undefined or invalid:",r);return}console.log("Fetched customers:",r.data);const t=r.data.map(s=>({value:s.cust_name,label:s.cust_name,refNo:s.cust_ref_no}));h(t)}catch(m){console.error("Error fetching customers:",m)}})()},[]),x.useEffect(()=>{if(a.quote_customer){const o=u.find(m=>m.value===a.quote_customer);f(o?[{value:o.refNo,label:o.refNo}]:[])}else f([])},[a.quote_customer,u]);const b=(o,m)=>{let r=m,t="";const s={...a,[o]:r},i=se.safeParse(s);if(!i.success){const c=i.error.errors.find(j=>j.path[0]===o);t=c?c.message:""}d(c=>({...c,[o]:t})),_(s)};return e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"equipment",children:["Load Type ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"equipment",value:a.quote_type,onChange:o=>_(m=>({...m,quote_type:o.target.value})),children:[e.jsx("option",{value:"",disabled:!0,children:"Select..."}),q.map(o=>e.jsx("option",{value:o,children:o},o))]}),n.quote_type&&e.jsx("span",{className:"error",style:{color:"red"},children:n.quote_type})]}),e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"customer",children:["Customer ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer",value:a.quote_customer||"",onChange:o=>b("quote_customer",o.target.value),onBlur:()=>b("quote_customer",a.quote_customer||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a customer"}),u.length>0?u.map((o,m)=>e.jsx("option",{value:o.value,children:o.label},`${o.refNo}-${m}`)):e.jsx("option",{disabled:!0,children:"No customers found"})]}),n.customer&&e.jsx("span",{className:"error",style:{color:"red"},children:n.customer})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsxs("label",{htmlFor:"customerRefNo",children:["Customer Ref. No ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer_ref_no",value:a.quote_cust_ref_no||"",onChange:o=>b("quote_cust_ref_no",o.target.value),onBlur:()=>b("quote_cust_ref_no",a.quote_cust_ref_no||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reference number"}),p.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]}),n.customer_ref_no&&e.jsx("span",{className:"error",style:{color:"red"},children:n.customer_ref_no})]}),ae.map(({key:o,label:m,placeholder:r,type:t})=>e.jsx("div",{children:e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[t==="boolean"?e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",id:o,checked:!!a[o],onChange:s=>b(o,s.target.checked),style:{transform:"scale(1.1)",cursor:"pointer",margin:0}}),e.jsx("label",{htmlFor:o,style:{margin:0,whiteSpace:"nowrap"},children:m})]}):e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsx("label",{htmlFor:o,children:m})," ",e.jsx("input",{type:"text",id:o,placeholder:r,value:String(a[o]||""),onChange:s=>b(o,s.target.value)})]}),n[o]&&e.jsx("span",{className:"error",style:{color:"red"},children:n[o]})]},o)},o))]})]})},oe=l.object({address:l.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:l.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:l.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:l.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:l.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:l.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:l.string().regex(/^\d{2}-\d{2}-\d{4}$/,{message:"Date must be in DD-MM-YYYY format"}).optional(),time:l.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:l.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:l.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),pickup_po:l.string().max(100,"Pickup PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid pickup PO format").optional(),packages:l.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:l.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:l.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:l.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),le=({setQuote:a,quote_pickup:_,index:n,handlePickupChange:d,handleRemovePickup:u,onAddPickup:h})=>{const p=_[n]??{},[f,q]=x.useState({}),b=O(r=>{const t=s=>{var i,c;return((c=(i=r.address_components)==null?void 0:i.find(j=>j.types.includes(s)))==null?void 0:c.long_name)||""};a(s=>({...s,quote_pickup:s.quote_pickup.map((i,c)=>c===n?{...i,address:`${t("street_number")} ${t("route")}`.trim(),city:t("locality"),state:t("administrative_area_level_1"),country:t("country"),postal:t("postal_code")}:i)}))}),o=x.useCallback((r,t)=>{const s=F.sanitize(t);let i=s;(r==="packages"||r==="weight")&&(i=s?Number(s):0);let c="";if(r==="date"&&/^\d{4}-\d{2}-\d{2}$/.test(s)){const[g,N,w]=s.split("-")}if(r==="date"){const g=new Date(t).toISOString().split("T")[0];d(n,{...p,[r]:g});return}const j={...p,[r]:i},C=oe.safeParse(j);if(!C.success){const g=C.error.errors.find(N=>N.path[0]===r);c=g?g.message:""}q(g=>({...g,[r]:c})),d(n,j)},[p,d,n]),m=[{label:"Address",key:"address",type:"text",placeholder:"Enter street address"},{label:"City",key:"city",type:"text",placeholder:"Enter city name"},{label:"State",key:"state",type:"text",placeholder:"Enter state"},{label:"Country",key:"country",type:"text",placeholder:"Enter country"},{label:"Postal Code",key:"postal",type:"text",placeholder:"Enter postal code"},{label:"Phone",key:"phone",type:"text",placeholder:"Enter phone number"},{label:"Date",key:"date",type:"date"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",type:"text",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",type:"text",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",type:"text",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",type:"number",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",type:"number",placeholder:"Enter weight (kg/lbs)"},{label:"Dimensions",key:"dimensions",type:"text",placeholder:"Enter dimensions (LxWxH cm/inches)"},{label:"Notes",key:"notes",type:"textarea",placeholder:"Enter additional notes"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:m.map(({label:r,key:t,type:s,placeholder:i})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${t}-${n}`,children:r}),s==="textarea"?e.jsx("textarea",{id:`${t}-${n}`,name:t,value:p[t]||"",onChange:c=>o(t,c.target.value),placeholder:i,rows:4}):e.jsx("input",{id:`${t}-${n}`,name:t,type:s,value:p[t]||"",onChange:c=>o(t,c.target.value),placeholder:i,ref:t==="address"?b:void 0}),f[t]&&e.jsx("span",{className:"error",style:{color:"red"},children:f[t]})]},t))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx($,{})}),e.jsx("button",{type:"button",onClick:()=>u(n),className:"delete-button",children:e.jsx(z,{})})]})]})},ne=l.object({address:l.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:l.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:l.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:l.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:l.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:l.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:l.string().regex(/^\d{2}-\d{2}-\d{4}$/,{message:"Date must be in DD-MM-YYYY format"}).optional(),time:l.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:l.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:l.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),delivery_po:l.string().max(100,"Delivery PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid delivery PO format").optional(),packages:l.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:l.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:l.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:l.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),ie=({setQuote:a,quote_delivery:_,index:n,handleDeliveryChange:d,handleRemoveDelivery:u,onAddDelivery:h})=>{const p=_[n]??{},[f,q]=x.useState({}),b=O(r=>{const t=s=>{var i,c;return((c=(i=r.address_components)==null?void 0:i.find(j=>j.types.includes(s)))==null?void 0:c.long_name)||""};a(s=>({...s,quote_delivery:s.quote_delivery.map((i,c)=>c===n?{...i,address:`${t("street_number")} ${t("route")}`.trim(),city:t("locality"),state:t("administrative_area_level_1"),country:t("country"),postal:t("postal_code")}:i)}))}),o=x.useCallback((r,t)=>{const s=F.sanitize(t);let i=s;(r==="packages"||r==="weight")&&(i=s?Number(s):0);let c="";if(r==="date"&&/^\d{4}-\d{2}-\d{2}$/.test(s)){const[g,N,w]=s.split("-")}if(r==="date"){const g=new Date(t).toISOString().split("T")[0];d(n,{...p,[r]:g});return}const j={...p,[r]:i},C=ne.safeParse(j);if(!C.success){const g=C.error.errors.find(N=>N.path[0]===r);c=g?g.message:""}q(g=>({...g,[r]:c})),d(n,j)},[p,d,n]),m=[{label:"Address",key:"address",type:"text",placeholder:"Enter street address"},{label:"City",key:"city",type:"text",placeholder:"Enter city name"},{label:"State",key:"state",type:"text",placeholder:"Enter state"},{label:"Country",key:"country",type:"text",placeholder:"Enter country"},{label:"Postal Code",key:"postal",type:"text",placeholder:"Enter postal code"},{label:"Phone",key:"phone",type:"text",placeholder:"Enter phone number"},{label:"Date",key:"date",type:"date",placeholder:"Enter date (YYYY-MM-DD)"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",type:"text",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",type:"text",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",type:"text",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",type:"number",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",type:"number",placeholder:"Enter weight (kg/lbs)"},{label:"Dimensions",key:"dimensions",type:"text",placeholder:"Enter dimensions (LxWxH cm/inches)"},{label:"Notes",key:"notes",type:"textarea",placeholder:"Enter additional notes"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:m.map(({label:r,key:t,type:s,placeholder:i})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${t}-${n}`,children:r}),s==="textarea"?e.jsx("textarea",{id:`${t}-${n}`,name:t,value:p[t]||"",onChange:c=>o(t,c.target.value),placeholder:i,rows:4}):e.jsx("input",{id:`${t}-${n}`,name:t,type:s,value:p[t]||"",onChange:c=>o(t,c.target.value),placeholder:i,ref:t==="address"?b:void 0}),f[t]&&e.jsx("span",{className:"error",style:{color:"red"},children:f[t]})]},t))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx($,{})}),e.jsx("button",{type:"button",onClick:()=>u(n),className:"delete-button",children:e.jsx(z,{})})]})]})},ce="https://linkloadsapiprod.onrender.com/api",de=(a,_,n)=>{const[d,u]=x.useState({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""});x.useEffect(()=>{if(a){const r=Array.isArray(a.quote_pickup)?a.quote_pickup:JSON.parse(a.quote_pickup||"[]"),t=Array.isArray(a.quote_delivery)?a.quote_delivery:JSON.parse(a.quote_delivery||"[]"),s={...a,quote_pickup:r.length>0?r:[],quote_delivery:t.length>0?t:[]};u(s)}},[a]);const h=()=>!!d.quote_type&&!!d.quote_customer&&!!d.quote_cust_ref_no;return{formQuote:d,setFormQuote:u,updateQuote:async()=>{var r,t;if(!h()){P.fire("Validation Error","Please fill in all required fields.","error");return}try{const s=localStorage.getItem("token");if(!s||typeof s!="string"){P.fire({icon:"error",title:"Unauthorized",text:"Please log in again."});return}const i=await D.put(`${ce}/quote/${d.id}`,d,{headers:{Authorization:`Bearer ${s}`}});P.fire({icon:"success",title:"Updated!",text:"Quote updated successfully."}),n(i.data),_()}catch(s){console.error("Error updating quote:",((r=s.response)==null?void 0:r.data)||s.message),P.fire({icon:"error",title:"Oops...",text:((t=s.response)==null?void 0:t.status)===401?"Unauthorized. Please log in again.":"Failed to update quote."})}},handleAddPickup:()=>{u(r=>r&&{...r,quote_pickup:[...r.quote_pickup,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]})},handleRemovePickup:r=>{u(t=>t&&{...t,quote_pickup:t.quote_pickup.filter((s,i)=>i!==r)})},handlePickupChange:(r,t)=>{u(s=>s&&{...s,quote_pickup:s.quote_pickup.map((i,c)=>c===r?t:i)})},handleAddDelivery:()=>{u(r=>r&&{...r,quote_delivery:[...r.quote_delivery,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]})},handleRemoveDelivery:r=>{u(t=>t&&{...t,quote_delivery:t.quote_delivery.filter((s,i)=>i!==r)})},handleDeliveryChange:(r,t)=>{u(s=>s&&{...s,quote_delivery:s.quote_delivery.map((i,c)=>c===r?t:i)})}}},ue=({quote:a,onClose:_,onUpdate:n})=>{var m;const{formQuote:d,setFormQuote:u,updateQuote:h,handleAddPickup:p,handleRemovePickup:f,handlePickupChange:q,handleAddDelivery:k,handleRemoveDelivery:b,handleDeliveryChange:o}=de(a,_,n);return e.jsx("div",{className:"form-container",children:e.jsxs("form",{onSubmit:r=>{r.preventDefault(),h()},className:"form-main",children:[d&&e.jsxs(e.Fragment,{children:[e.jsx(re,{formQuote:d,setFormQuote:u}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Origin"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[(m=d.quote_pickup)==null?void 0:m.map((r,t)=>e.jsx(le,{quote:d,setQuote:u,quote_pickup:d.quote_pickup,index:t,onAddPickup:p,handlePickupChange:q,handleRemovePickup:f},t)),d.quote_pickup.length===0&&e.jsx("button",{type:"button",onClick:p,className:"add-button",children:e.jsx($,{})})]})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Destination"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[d.quote_delivery.map((r,t)=>e.jsx(ie,{quote:d,setQuote:u,quote_delivery:d.quote_delivery,index:t,onAddDelivery:k,handleDeliveryChange:o,handleRemoveDelivery:b},t)),d.quote_delivery.length===0&&e.jsx("button",{type:"button",onClick:k,className:"add-button",children:e.jsx($,{})})]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-submit",children:"Save"}),e.jsx("button",{type:"button",className:"btn-cancel",onClick:_,children:"Cancel"})]})]})})},me=({formQuote:a})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"quoteType",children:"Quote Type"}),e.jsx("div",{children:a.quote_type||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"quote_customer",children:"Customer"}),e.jsx("div",{children:a.quote_customer||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"customerRefNo",children:"Customer Ref. No"}),e.jsx("div",{children:a.quote_cust_ref_no||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"accNo",children:"Booked By"}),e.jsx("div",{children:a.quote_booked_by||"N/A"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"branch",children:"Temperature"}),e.jsx("div",{children:a.quote_temperature||"N/A"})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Hot",style:{display:"block"},children:"Hot"}),e.jsx("span",{children:a.quote_hot?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Team",style:{display:"block"},children:"Team"}),e.jsx("span",{children:a.quote_team?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Air Ride",style:{display:"block"},children:"Air Ride"}),e.jsx("span",{children:a.quote_air_ride?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"TARP",style:{display:"block"},children:"TARP"}),e.jsx("span",{children:a.quote_tarp?"Yes":"No"})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{htmlFor:"Hazmat",style:{display:"block"},children:"Hazmat"}),e.jsx("span",{children:a.quote_hazmat?"Yes":"No"})]})]})]}),pe=({delivery:a})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Address"}),e.jsx("div",{children:a.address||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"City"}),e.jsx("div",{children:a.city||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"State"}),e.jsx("div",{children:a.state||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Postal Code"}),e.jsx("div",{children:a.postal||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:a.country||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Date"}),e.jsx("div",{children:a.date||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Time"}),e.jsx("div",{children:a.time||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Currency"}),e.jsx("div",{children:a.currency||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Equipment"}),e.jsx("div",{children:a.equipment||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Pickup PO"}),e.jsx("div",{children:a.pickup_po||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Phone"}),e.jsx("div",{children:a.phone||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Packages"}),e.jsx("div",{children:a.packages||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Weight"}),e.jsx("div",{children:a.weight||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Dimensions"}),e.jsx("div",{children:a.dimensions||""})]})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Notes"}),e.jsx("div",{children:a.notes||""})]})]}),he=({pickup:a})=>e.jsxs("fieldset",{className:"form-section",children:[e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Address"}),e.jsx("div",{children:a.address||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"City"}),e.jsx("div",{children:a.city||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"State"}),e.jsx("div",{children:a.state||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Postal Code"}),e.jsx("div",{children:a.postal||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Country"}),e.jsx("div",{children:a.country||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Date"}),e.jsx("div",{children:a.date||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Time"}),e.jsx("div",{children:a.time||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Currency"}),e.jsx("div",{children:a.currency||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Equipment"}),e.jsx("div",{children:a.equipment||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Pickup PO"}),e.jsx("div",{children:a.pickup_po||""})]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Phone"}),e.jsx("div",{children:a.phone||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Packages"}),e.jsx("div",{children:a.packages||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Weight"}),e.jsx("div",{children:a.weight||""})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Dimensions"}),e.jsx("div",{children:a.dimensions||""})]})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{children:"Notes"}),e.jsx("div",{children:a.notes||""})]})]}),xe=({quote:a,onClose:_})=>{const[n,d]=x.useState({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""});return x.useEffect(()=>{if(console.log("quote:",a),console.log("quote_pickup:",a==null?void 0:a.quote_pickup),a){let u=[],h=[];if(Array.isArray(a.quote_pickup))u=a.quote_pickup;else if(typeof a.quote_pickup=="string")try{u=JSON.parse(a.quote_pickup),Array.isArray(u)||(u=[])}catch(p){console.error("Failed to parse quote_pickup:",p),u=[]}if(Array.isArray(a.quote_delivery))h=a.quote_delivery;else if(typeof a.quote_delivery=="string")try{h=JSON.parse(a.quote_delivery),Array.isArray(h)||(h=[])}catch(p){console.error("Failed to parse quote_delivery:",p),h=[]}d({...a,quote_pickup:u,quote_delivery:h})}},[a]),e.jsx("div",{className:"form-container",children:e.jsxs("form",{className:"form-main",children:[e.jsx(me,{formQuote:n}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Pickup"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:n.quote_pickup.map((u,h)=>e.jsx(he,{pickup:u,index:h},h))})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Delivery"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:n.quote_delivery.map((u,h)=>e.jsx(pe,{delivery:u,index:h},h))})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"button",className:"btn-cancel",onClick:_,style:{padding:"9px 15px"},children:"Cancel"})})]})})},U="https://linkloadsapiprod.onrender.com/api",ge=()=>{const[a,_]=x.useState([]),[n,d]=x.useState(!0),[u,h]=x.useState(""),[p,f]=x.useState("created_at"),[q,k]=x.useState(!0),[b,o]=x.useState(1),[m,r]=x.useState(null),[t,s]=x.useState(!1),[i,c]=x.useState(!1),[j,C]=x.useState(!1),[g,N]=x.useState([]),[w,V]=x.useState(10),[Z,R]=x.useState(!1),[I,Y]=x.useState({subject:"",content:""}),T=async()=>{try{const y=localStorage.getItem("token");if(!y)throw new Error("No token found");d(!0);const{data:E}=await D.get(`${U}/quote`,{headers:{Authorization:`Bearer ${y}`}});_(E)}catch(y){console.error("Error loading quotes:",y),B(y)}finally{d(!1)}};x.useEffect(()=>{T()},[]);const B=y=>{y.response&&y.response.status===401&&P.fire({icon:"error",title:"Unauthorized",text:"You need to log in to access this resource."})},H=y=>{p===y?k(!q):(f(y),k(!1))},v=a.filter(y=>Object.values(y).some(E=>E==null?void 0:E.toString().toLowerCase().includes(u.toLowerCase()))),L=v.sort((y,E)=>{let A=y[p]??"",S=E[p]??"";return typeof A=="string"&&typeof S=="string"?q?S.localeCompare(A):A.localeCompare(S):typeof A=="number"&&typeof S=="number"?q?S-A:A-S:0}).slice((b-1)*w,b*w),Q=Math.ceil(v.length/w);return{fetchQuotes:T,quotes:a,loading:n,searchQuery:u,setSearchQuery:h,sortBy:p,sortDesc:q,selectedIds:g,setSelectedIds:N,paginatedData:L,totalPages:Q,currentPage:b,setCurrentPage:o,isEditModalOpen:t,isAddModalOpen:i,isViewModalOpen:j,isEmailModalOpen:Z,selectedQuote:m,openEditModal:y=>{r(y),s(!0)},closeEditModal:()=>{s(!1),r(null)},openViewModal:y=>{r(y),C(!0)},closeViewModal:()=>{C(!1),r(null)},setEditModalOpen:s,setAddModalOpen:c,setViewModalOpen:C,setEmailModalOpen:R,toggleSelectAll:()=>{g.length===L.length?N([]):N(L.map(y=>y.id))},toggleSelect:y=>{N(E=>E.includes(y)?E.filter(A=>A!==y):[...E,y])},deleteSelected:async()=>{if(g.length===0){P.fire({icon:"warning",title:"No record selected",text:"Please select a record to delete."});return}if((await P.fire({title:"Are you sure?",text:"This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete selected!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const E=localStorage.getItem("token");if(!E)throw new Error("No token found");await Promise.all(g.map(A=>D.delete(`${U}/quote/${A}`,{headers:{Authorization:`Bearer ${E}`}}))),_(A=>A.filter(S=>!g.includes(S.id))),N([]),P.fire("Deleted!","Selected quotes have been deleted.","success")}catch(E){console.error("Error deleting quotes:",E),P.fire({icon:"error",title:"Error!",text:"Failed to delete selected quotes."})}},emailData:I,setEmailData:Y,sendEmails:async()=>{if(g.length===0){P.fire({icon:"warning",title:"No quotes selected",text:"Please select quotes to send emails to."});return}try{const y=localStorage.getItem("token");if(!y)throw new Error("No token found");await D.post(`${U}/email`,{ids:g,...I,module:"quotes"},{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}}),P.fire("Success!","Emails have been sent.","success"),R(!1),N([])}catch(y){console.error("Error sending emails:",y),P.fire("Error!","Failed to send emails.","error")}},handleSort:H,updateQuote:y=>{_(E=>E.map(A=>A.id===y.id?{...A,...y}:A))},handlePageChange:y=>{o(y)}}},ye=l.object({load_type:l.enum(["FTL","LTL"],{message:"Please select a valid load type"}),quote_booked_by:l.string().max(100,"Booked By cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]*$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed").optional(),quote_temperature:l.union([l.string().max(10,"Temperature cannot exceed 10 characters").regex(/^-?\d+(\.\d+)?\s?[°CFK]?$/,"Enter a valid temperature (e.g., 5°C, -10F, 273K)"),l.number()]).optional(),quote_customer:l.string().min(1,"Customer is required").max(200,"Customer name cannot exceed 200 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_cust_ref_no:l.string().min(1,"Customer Ref. No is required").max(100,"Customer Ref. No cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'"-]+$/,"Only letters, numbers, spaces, apostrophes, periods, commas, and hyphens allowed"),quote_hot:l.boolean().optional(),quote_team:l.boolean().optional(),quote_air_ride:l.boolean().optional(),quote_tarp:l.boolean().optional(),quote_hazmat:l.boolean().optional()}),fe=[{key:"quote_booked_by",label:"Booked By",placeholder:"Enter Person Who Booked",type:"text"},{key:"quote_temperature",label:"Temperature",placeholder:"Enter Required Temperature",type:"text"},{key:"quote_hot",label:"Hot",type:"boolean"},{key:"quote_team",label:"Team",type:"boolean"},{key:"quote_air_ride",label:"Air Ride",type:"boolean"},{key:"quote_tarp",label:"TARP",type:"boolean"},{key:"quote_hazmat",label:"Hazmat",type:"boolean"}],be=({quote:a,setQuote:_})=>{const[n,d]=x.useState({}),[u,h]=x.useState([]),[p,f]=x.useState([]),q=["FTL","LTL"],k="https://linkloadsapiprod.onrender.com/api";x.useEffect(()=>{(async()=>{try{const m=localStorage.getItem("token"),r=await D.get(`${k}/customer`,{headers:{Authorization:`Bearer ${m}`}});if(!r||!r.data){console.error("API response is undefined or invalid:",r);return}console.log("Fetched customers:",r.data);const t=r.data.map(s=>({value:s.cust_name,label:s.cust_name,refNo:s.cust_ref_no}));h(t)}catch(m){console.error("Error fetching customers:",m)}})()},[]),x.useEffect(()=>{if(a.quote_customer){const o=u.find(m=>m.value===a.quote_customer);f(o?[{value:o.refNo,label:o.refNo}]:[])}else f([])},[a.quote_customer,u]);const b=(o,m)=>{let r=m,t="";const s={...a,[o]:r},i=ye.safeParse(s);if(!i.success){const c=i.error.errors.find(j=>j.path[0]===o);t=c?c.message:""}d(c=>({...c,[o]:t})),_(s)};return e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"General"}),e.jsx("hr",{}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"equipment",children:["Load Type ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"equipment",value:a.quote_type,onChange:o=>_(m=>({...m,quote_type:o.target.value})),children:[e.jsx("option",{value:"",children:"Select..."}),q.map(o=>e.jsx("option",{value:o,children:o},o))]}),n.quote_type&&e.jsx("span",{className:"error",style:{color:"red"},children:n.quote_type})]}),e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsxs("label",{htmlFor:"customer",children:["Customer ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer",value:a.quote_customer||"",onChange:o=>b("quote_customer",o.target.value),onBlur:()=>b("quote_customer",a.quote_customer||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a customer"}),u.length>0?u.map((o,m)=>e.jsx("option",{value:o.value,children:o.label},`${o.refNo}-${m}`)):e.jsx("option",{disabled:!0,children:"No customers found"})]}),n.customer&&e.jsx("span",{className:"error",style:{color:"red"},children:n.customer})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsxs("label",{htmlFor:"customerRefNo",children:["Customer Ref. No ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{id:"quote_customer_ref_no",value:a.quote_cust_ref_no||"",onChange:o=>b("quote_cust_ref_no",o.target.value),onBlur:()=>b("quote_cust_ref_no",a.quote_cust_ref_no||""),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a reference number"}),p.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]}),n.customer_ref_no&&e.jsx("span",{className:"error",style:{color:"red"},children:n.customer_ref_no})]}),fe.map(({key:o,label:m,placeholder:r,type:t})=>e.jsx("div",{children:e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[t==="boolean"?e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",id:o,checked:!!a[o],onChange:s=>b(o,s.target.checked),style:{transform:"scale(1.1)",cursor:"pointer",margin:0}}),e.jsx("label",{htmlFor:o,style:{margin:0,whiteSpace:"nowrap"},children:m})]}):e.jsxs("div",{className:"form-group",style:{flex:"1 1 45%"},children:[e.jsx("label",{htmlFor:o,children:m})," ",e.jsx("input",{type:"text",id:o,placeholder:r,value:String(a[o]||""),onChange:s=>b(o,s.target.value)})]}),n[o]&&e.jsx("span",{className:"error",style:{color:"red"},children:n[o]})]},o)},o))]})]})},je=l.object({address:l.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:l.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:l.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:l.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:l.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:l.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:l.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be in YYYY-MM-DD format").optional(),time:l.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:l.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:l.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),pickup_po:l.string().max(100,"Pickup PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid pickup PO format").optional(),packages:l.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:l.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:l.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:l.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),_e=({setQuote:a,quote_pickup:_,index:n,handlePickupChange:d,handleRemovePickup:u,onAddPickup:h})=>{const p=_[n]??{},[f,q]=x.useState({}),b=O(r=>{const t=s=>{var i,c;return((c=(i=r.address_components)==null?void 0:i.find(j=>j.types.includes(s)))==null?void 0:c.long_name)||""};a(s=>({...s,quote_pickup:s.quote_pickup.map((i,c)=>c===n?{...i,address:`${t("street_number")} ${t("route")}`.trim(),city:t("locality"),state:t("administrative_area_level_1"),country:t("country"),postal:t("postal_code")}:i)}))}),o=x.useCallback((r,t)=>{const s=F.sanitize(t);let i=s;(r==="packages"||r==="weight")&&(i=s?Number(s):0);let c="";const j={...p,[r]:i},C=je.safeParse(j);if(!C.success){const g=C.error.errors.find(N=>N.path[0]===r);c=g?g.message:""}q(g=>({...g,[r]:c})),d(n,j)},[p,d,n]),m=[{label:"Address",key:"address",placeholder:"Enter street address"},{label:"City",key:"city",placeholder:"Enter city name"},{label:"State",key:"state",placeholder:"Enter state"},{label:"Country",key:"country",placeholder:"Enter country"},{label:"Postal Code",key:"postal",placeholder:"Enter postal code"},{label:"Phone",key:"phone",placeholder:"Enter phone number"},{label:"Date",key:"date",placeholder:"Enter date (YYYY-MM-DD)"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",placeholder:"Enter equipment details"},{label:"Pickup PO",key:"pickup_po",placeholder:"Enter pickup PO number"},{label:"Packages",key:"packages",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",placeholder:"Enter weight (kg/lbs)"},{label:"Dimensions",key:"dimensions",placeholder:"Enter dimensions (LxWxH cm/inches)"},{label:"Notes",key:"notes",placeholder:"Enter additional notes"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:m.map(({label:r,key:t,placeholder:s})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${t}-${n}`,children:r}),e.jsx("input",{id:`${t}-${n}`,name:t,type:"text",value:p[t]||"",onChange:i=>o(t,i.target.value),placeholder:s,ref:t==="address"?b:void 0}),f[t]&&e.jsx("span",{className:"error",style:{color:"red"},children:f[t]})]},t))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx($,{})}),e.jsx("button",{type:"button",onClick:()=>u(n),className:"delete-button",children:e.jsx(z,{})})]})]})},ve=l.object({address:l.string().max(255,"Address is too long").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid address format").optional(),city:l.string().max(100,"City name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid city format").optional(),state:l.string().max(100,"State name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid state format").optional(),country:l.string().max(100,"Country name is too long").regex(/^[a-zA-Z\s.'-]*$/,"Invalid country format").optional(),postal:l.string().max(20,"Postal code cannot exceed 20 characters").regex(/^[a-zA-Z0-9\s-]*$/,"Invalid postal code format").optional(),phone:l.string().max(30,"Phone number cannot exceed 30 characters").regex(/^[0-9+\-()\s]*$/,"Invalid phone number format").optional(),date:l.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be in YYYY-MM-DD format").optional(),time:l.string().regex(/^([01]\d|2[0-3]):([0-5]\d)$/,"Time must be in HH:MM format (24-hour)").optional(),currency:l.string().max(50,"Currency code cannot exceed 50 characters").regex(/^[A-Z]{3}$/,"Invalid currency format (e.g., USD, EUR)").optional(),equipment:l.string().max(100,"Equipment description cannot exceed 100 characters").regex(/^[a-zA-Z0-9\s.,'-]*$/,"Invalid equipment format").optional(),delivery_po:l.string().max(100,"Delivery PO cannot exceed 50 characters").regex(/^[a-zA-Z0-9\s.-]*$/,"Invalid delivery PO format").optional(),packages:l.number().int().min(1,"Packages must be at least 1").max(99999,"Packages cannot exceed 99,999").optional(),weight:l.number().min(0,"Weight cannot be negative").max(1e6,"Weight cannot exceed 1,000,000 kg").optional(),dimensions:l.string().max(100,"Dimensions cannot exceed 100 characters").regex(/^\d+x\d+x\d*$/,"Invalid dimensions format (e.g., 10x20x30)").optional(),notes:l.string().max(500,"Notes cannot exceed 500 characters").regex(/^[a-zA-Z0-9\s,.'-]*$/,"Invalid notes format").optional()}),qe=({setQuote:a,quote_delivery:_,index:n,handleDeliveryChange:d,handleRemoveDelivery:u,onAddDelivery:h})=>{const p=_[n]??{},[f,q]=x.useState({}),b=O(r=>{const t=s=>{var i,c;return((c=(i=r.address_components)==null?void 0:i.find(j=>j.types.includes(s)))==null?void 0:c.long_name)||""};a(s=>({...s,quote_delivery:s.quote_delivery.map((i,c)=>c===n?{...i,address:`${t("street_number")} ${t("route")}`.trim(),city:t("locality"),state:t("administrative_area_level_1"),country:t("country"),postal:t("postal_code")}:i)}))}),o=x.useCallback((r,t)=>{const s=F.sanitize(t);let i=s;(r==="packages"||r==="weight")&&(i=s?Number(s):0);let c="";const j={...p,[r]:i},C=ve.safeParse(j);if(!C.success){const g=C.error.errors.find(N=>N.path[0]===r);c=g?g.message:""}q(g=>({...g,[r]:c})),d(n,j)},[p,d,n]),m=[{label:"Address",key:"address",placeholder:"Enter street address"},{label:"City",key:"city",placeholder:"Enter city name"},{label:"State",key:"state",placeholder:"Enter state"},{label:"Country",key:"country",placeholder:"Enter country"},{label:"Postal Code",key:"postal",placeholder:"Enter postal code"},{label:"Phone",key:"phone",placeholder:"Enter phone number"},{label:"Date",key:"date",placeholder:"Enter date (YYYY-MM-DD)"},{label:"Time",key:"time",placeholder:"Enter time (HH:MM)"},{label:"Currency",key:"currency",placeholder:"Enter currency (e.g., USD, EUR)"},{label:"Equipment",key:"equipment",placeholder:"Enter equipment details"},{label:"Delivery PO",key:"delivery_po",placeholder:"Enter delivery PO number"},{label:"Packages",key:"packages",placeholder:"Enter number of packages"},{label:"Weight",key:"weight",placeholder:"Enter weight (kg/lbs)"},{label:"Dimensions",key:"dimensions",placeholder:"Enter dimensions (LxWxH cm/inches)"},{label:"Notes",key:"notes",placeholder:"Enter additional notes"}];return e.jsxs("fieldset",{className:"form-section",style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{className:"form-grid",style:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(5, 1fr)",flex:1},children:m.map(({label:r,key:t,placeholder:s})=>e.jsxs("div",{className:"form-group",style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{htmlFor:`${t}-${n}`,children:r}),e.jsx("input",{id:`${t}-${n}`,name:t,type:"text",value:p[t]||"",onChange:i=>o(t,i.target.value),placeholder:s,ref:t==="address"?b:void 0}),f[t]&&e.jsx("span",{className:"error",style:{color:"red"},children:f[t]})]},t))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0px"},children:[e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx($,{})}),e.jsx("button",{type:"button",onClick:()=>u(n),className:"delete-button",children:e.jsx(z,{})})]})]})},W="https://linkloadsapiprod.onrender.com/api",ke=(a,_)=>{const n={id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""},[d,u]=x.useState(n),h=()=>!!d.quote_type&&!!d.quote_customer,p=async t=>{if(t.preventDefault(),!h()){P.fire("Validation Error","Please fill in all required fields.","error");return}try{const s=localStorage.getItem("token");if(!s){P.fire("Error","No token found","error");return}const i={Authorization:`Bearer ${s}`},c=d.id?await D.put(`${W}/quote/${d.id}`,d,{headers:i}):await D.post(`${W}/quote`,d,{headers:i});P.fire(d.id?"Success!":"Saved!","Quote created successfully.","success"),f(),_()}catch(s){console.error("Error saving/updating quote:",s.response?s.response.data:s.message),P.fire("Error","An error occurred while processing the quote.","error")}},f=()=>{u({id:0,quote_type:"",quote_customer:"",quote_cust_ref_no:"",quote_booked_by:"",quote_temperature:"",quote_hot:!1,quote_team:!1,quote_air_ride:!1,quote_tarp:!1,quote_hazmat:!1,quote_pickup:[],quote_delivery:[],created_at:"",updated_at:""})};return{quote:d,setQuote:u,handleSubmit:p,clearQuoteForm:f,handleAddPickup:()=>{u(t=>({...t,quote_pickup:[...t.quote_pickup,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]}))},handlePickupChange:(t,s)=>{const i=d.quote_pickup.map((c,j)=>j===t?s:c);u(c=>({...c,quote_pickup:i}))},handleRemovePickup:t=>{u(s=>({...s,quote_pickup:s.quote_pickup.filter((i,c)=>c!==t)}))},handleAddDelivery:()=>{u(t=>({...t,quote_delivery:[...t.quote_delivery,{address:"",city:"",state:"",postal:"",country:"",date:"",time:"",currency:"",equipment:"",pickup_po:"",phone:"",packages:0,weight:0,dimensions:"",notes:""}]}))},handleDeliveryChange:(t,s)=>{const i=d.quote_delivery.map((c,j)=>j===t?s:c);u(c=>({...c,quote_delivery:i}))},handleRemoveDelivery:t=>{u(s=>({...s,quote_delivery:s.quote_delivery.filter((i,c)=>c!==t)}))}}},Ne=({onClose:a,onSuccess:_})=>{const{quote:n,setQuote:d,handleSubmit:u,handleAddPickup:h,handlePickupChange:p,handleRemovePickup:f,handleAddDelivery:q,handleDeliveryChange:k,handleRemoveDelivery:b}=ke(a,_);return e.jsx("div",{className:"form-container",children:e.jsx("form",{onSubmit:u,className:"form-main",children:e.jsxs("div",{className:"submit-button-container",children:[e.jsx(be,{quote:n,setQuote:d}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Pickup"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:n.quote_pickup.map((o,m)=>e.jsx(_e,{quote:n,setQuote:d,quote_pickup:n.quote_pickup,index:m,onAddPickup:h,handlePickupChange:p,handleRemovePickup:f},m))}),n.quote_pickup.length===0&&e.jsx("button",{type:"button",onClick:h,className:"add-button",children:e.jsx($,{})})]}),e.jsxs("fieldset",{className:"form-section",children:[e.jsx("legend",{children:"Delivery"}),e.jsx("hr",{}),e.jsx("div",{className:"form-row",children:n.quote_delivery.map((o,m)=>e.jsx(qe,{quote:n,setQuote:d,quote_delivery:n.quote_delivery,index:m,onAddDelivery:q,handleDeliveryChange:k,handleRemoveDelivery:b},m))}),n.quote_delivery.length===0&&e.jsx("button",{type:"button",onClick:q,className:"add-button",children:e.jsx($,{})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-submit",children:"Create Quote"}),e.jsx("button",{type:"button",className:"btn-cancel",onClick:a,children:"Cancel"})]})]})})})},Ce=()=>{const{fetchQuotes:a,quotes:_,loading:n,searchQuery:d,setSearchQuery:u,sortBy:h,sortDesc:p,selectedIds:f,paginatedData:q,totalPages:k,currentPage:b,isEditModalOpen:o,isAddModalOpen:m,isViewModalOpen:r,isEmailModalOpen:t,selectedQuote:s,openEditModal:i,closeEditModal:c,openViewModal:j,closeViewModal:C,setAddModalOpen:g,setEmailModalOpen:N,toggleSelectAll:w,toggleSelect:V,deleteSelected:Z,sendEmails:R,handleSort:I,updateQuote:Y,handlePageChange:T}=ge(),B=v=>v.key==="checkbox"||v.key==="actions"?v.label:e.jsxs("div",{className:"sortable-header",onClick:()=>I(v.key),children:[v.label,e.jsx("span",{className:"sort-icon",children:h===v.key?p?"▼":"▲":"▼"})]}),H=[{key:"checkbox",label:e.jsx("input",{type:"checkbox",checked:f.length===q.length&&q.length>0,onChange:w}),render:v=>e.jsx("input",{type:"checkbox",checked:f.includes(v.id),onChange:()=>V(v.id)})},{key:"quote_customer",label:"Customer",render:v=>v.quote_customer||e.jsx("span",{children:"-"})},{key:"quote_cust_ref_no",label:"Customer Ref#",render:v=>v.quote_cust_ref_no||e.jsx("span",{children:"-"})},{key:"quote_type",label:"Type",render:v=>v.quote_type||e.jsx("span",{children:"-"})},{key:"quote_booked_by",label:"Booked by",render:v=>v.quote_booked_by||e.jsx("span",{children:"-"})},{key:"actions",label:"Actions",render:v=>e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>j(v),className:"btn-view",children:e.jsx(X,{})}),e.jsx("button",{onClick:()=>i(v),className:"btn-edit",children:e.jsx(G,{})})]})}];return e.jsxs("div",{children:[e.jsxs("div",{className:"header-container",children:[e.jsx("div",{className:"header-container-left",children:e.jsx("div",{className:"header-actions",children:e.jsx("h1",{className:"page-heading",children:"Quotes"})})}),e.jsxs("div",{className:"search-container",children:[e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx(ee,{className:"search-icon"}),e.jsx("input",{className:"search-bar",value:d,onChange:v=>u(v.target.value)})]}),e.jsxs("button",{onClick:()=>g(!0),className:"add-button",children:[e.jsx($,{})," New"]})]})]}),f.length>0&&e.jsxs("div",{className:"selection-banner",children:[e.jsxs("span",{children:[f.length," item",f.length>1?"s":""," selected"]}),e.jsxs("button",{onClick:()=>N(!0),className:"send-email-button",disabled:f.length===0,children:[e.jsx(te,{}),"  Send Email"]}),e.jsxs("button",{className:"text-delete-btn",onClick:Z,children:[e.jsx(z,{}),"  Delete"]})]}),n?e.jsx("div",{children:"Loading..."}):_.length===0?e.jsx("div",{children:"No records found"}):e.jsx(J,{data:q,headers:H.map(v=>({...v,label:B(v)})),handleSort:I,sortBy:h,sortDesc:p}),e.jsx(K,{currentPage:b,totalPages:k,onPageChange:T}),e.jsx(M,{isOpen:m,onClose:()=>g(!1),title:"Add Quote",children:e.jsx(Ne,{onClose:()=>g(!1),onSuccess:a})}),e.jsx(M,{isOpen:o,onClose:c,title:"Edit Quote",children:s?e.jsx(ue,{quote:s,onClose:c,onUpdate:Y}):e.jsx("p",{children:"No quote selected for editing."})}),e.jsx(M,{isOpen:t,onClose:()=>N(!1),title:"Send Email",children:e.jsx("button",{onClick:R,children:"Send"})}),e.jsx(M,{isOpen:r,onClose:C,title:"Quote Details",children:s&&e.jsx(xe,{quote:s,onClose:C})})]})},Ue=()=>e.jsx("div",{children:e.jsx(Ce,{})});export{Ue as default};
